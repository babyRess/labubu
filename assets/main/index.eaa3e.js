System.register("chunks:///_virtual/AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./SettingsManager.ts"],(function(o){var i,e,n,t,u,a,s,r,l,c,d,h,f,S,g,m;return{setters:[function(o){i=o.inheritsLoose,e=o.createForOfIteratorHelperLoose,n=o.createClass,t=o.asyncToGenerator,u=o.regeneratorRuntime},function(o){a=o.cclegacy,s=o._decorator,r=o.director,l=o.Node,c=o.AudioSource,d=o.tween,h=o.resources,f=o.AudioClip,S=o.Component},function(o){g=o.GameConfig},function(o){m=o.SettingsManager}],execute:function(){var A,p;a._RF.push({},"c3d4eX2p7iQEs3vEjRWeJAS","AudioManager",void 0);var _=s.ccclass;o("AudioManager",_("AudioManager")(((p=function(o){function a(){for(var i,e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return(i=o.call.apply(o,[this].concat(n))||this).bgmAudioSource=null,i.sfxAudioSource=null,i.sfxPoolContainer=null,i._audioClipCache=new Map,i._sfxPool=[],i._maxSfxSources=5,i._currentBgm="",i._defaultFadeDuration=1,i._isFading=!1,i._targetBgmVolume=1,i}i(a,o);var s=a.prototype;return s.onLoad=function(){if(a._instance)return console.warn("Multiple AudioManager instances detected!"),void this.node.destroy();a._instance=this,r.addPersistRootNode(this.node),this.initializeAudio(),console.log("AudioManager initialized and persisted across scenes")},s.start=function(){this.applySettings()},s.onDestroy=function(){a._instance===this&&(a._instance=null),this._audioClipCache.clear(),this._sfxPool=[]},s.initializeAudio=function(){var o=new l("BGM_AudioSource");o.setParent(this.node),this.bgmAudioSource=o.addComponent(c),this.bgmAudioSource.loop=!0,this.bgmAudioSource.playOnAwake=!1;var i=new l("SFX_AudioSource");i.setParent(this.node),this.sfxAudioSource=i.addComponent(c),this.sfxAudioSource.loop=!1,this.sfxAudioSource.playOnAwake=!1,this.createSfxPool(),console.log("Audio sources created dynamically")},s.createSfxPool=function(){Array.isArray(this._sfxPool)?this._sfxPool.length=0:this._sfxPool=[],this.sfxPoolContainer?this.sfxPoolContainer.removeAllChildren():(this.sfxPoolContainer=new l("SFX_Pool"),this.sfxPoolContainer.setParent(this.node));for(var o=0;o<this._maxSfxSources;o++){var i=new l("SFX_"+o);i.setParent(this.sfxPoolContainer);var e=i.addComponent(c);e.loop=!1,e.playOnAwake=!1,this._sfxPool.push(e)}console.log("Created SFX pool with "+this._maxSfxSources+" sources")},s.ensureSfxPoolInitialized=function(){Array.isArray(this._sfxPool)&&0!==this._sfxPool.length||this.createSfxPool()},s.applySettings=function(){var o=m.instance;o&&(this.setBgmVolume(o.bgmVolume),this.setSfxVolume(o.sfxVolume),o.bgmEnabled||this.stopBGM())},s.playBGM=function(o,i,e){var n=this;void 0===i&&(i=!1),void 0===e&&(e=0);var t=m.instance;t&&t.bgmEnabled&&(this.bgmAudioSource?this._currentBgm===o&&this.bgmAudioSource.playing&&!i||(this._currentBgm=o,this.loadAudioClip(o,(function(i){i&&n.bgmAudioSource&&(n.bgmAudioSource.clip=i,e>0?(n.bgmAudioSource.volume=0,n.bgmAudioSource.play(),n.fadeBGMIn(e),console.log("Playing BGM with "+e+"s fade-in: "+o)):(n.bgmAudioSource.play(),console.log("Playing BGM: "+o)))}))):console.warn("BGM AudioSource not found"))},s.stopBGM=function(){this.bgmAudioSource&&this.bgmAudioSource.playing&&(this.bgmAudioSource.stop(),this._currentBgm="",console.log("BGM stopped"))},s.pauseBGM=function(){this.bgmAudioSource&&this.bgmAudioSource.playing&&(this.bgmAudioSource.pause(),console.log("BGM paused"))},s.resumeBGM=function(){var o=m.instance;o&&o.bgmEnabled&&this.bgmAudioSource&&(this.bgmAudioSource.play(),console.log("BGM resumed"))},s.setBgmVolume=function(o){var i=Math.max(0,Math.min(1,o));this._targetBgmVolume=i,this.bgmAudioSource&&!this._isFading&&(this.bgmAudioSource.volume=i),m.instance&&(m.instance.bgmVolume=i)},s.getBgmVolume=function(){return this.bgmAudioSource?this.bgmAudioSource.volume:0},s.fadeBGMIn=function(o){var i=this;if(void 0===o&&(o=this._defaultFadeDuration),this.bgmAudioSource){var e=m.instance;if(e&&e.bgmEnabled){this._isFading=!0;var n=this._targetBgmVolume;this.bgmAudioSource.volume=0,this.bgmAudioSource.playing||this.bgmAudioSource.play(),d(this.bgmAudioSource).to(o,{volume:n},{onComplete:function(){i._isFading=!1,console.log("BGM faded in to volume "+n)}}).start()}}},s.fadeBGMOut=function(o,i){var e=this;void 0===o&&(o=this._defaultFadeDuration),void 0===i&&(i=!0),this.bgmAudioSource&&this.bgmAudioSource.playing&&(this._isFading=!0,d(this.bgmAudioSource).to(o,{volume:0},{onComplete:function(){e._isFading=!1,i?(e.bgmAudioSource.stop(),console.log("BGM faded out and stopped")):console.log("BGM faded out")}}).start())},s.crossfadeBGM=function(o,i){var e=this;void 0===i&&(i=this._defaultFadeDuration);var n=m.instance;if(n&&n.bgmEnabled)if(this.bgmAudioSource){if(this._currentBgm!==o||!this.bgmAudioSource.playing){var t=this.bgmAudioSource.playing;t&&this.fadeBGMOut(i/2,!0),this._currentBgm=o,this.loadAudioClip(o,(function(n){n&&e.bgmAudioSource&&setTimeout((function(){e.bgmAudioSource.clip=n,e.fadeBGMIn(i/2),console.log("Crossfading to BGM: "+o)}),1e3*(t?i/2:0))}))}}else console.warn("BGM AudioSource not found")},s.playSFX=function(o,i){void 0===i&&(i=1);var e=m.instance;if(e&&e.sfxEnabled){this.ensureSfxPoolInitialized();var n=this.getAvailableSfxSource();n?this.loadAudioClip(o,(function(o){o&&n&&(n.clip=o,n.volume=e.sfxVolume*i,n.play())})):console.warn("No available SFX audio source")}},s.playSFXByName=function(o,i){void 0===i&&(i=1);var e=g.instance,n="";switch(o.toLowerCase()){case"button":n=e.RESOURCE_PATHS.SFX_BUTTON;break;case"scratch":n=e.RESOURCE_PATHS.SFX_SCRATCH;break;case"show1":n=e.RESOURCE_PATHS.SFX_SHOW1;break;case"show2":n=e.RESOURCE_PATHS.SFX_SHOW2;break;case"win_small":case"common_win1":n=e.RESOURCE_PATHS.SFX_WIN_SMALL;break;case"win_big":case"common_win2":n=e.RESOURCE_PATHS.SFX_WIN_BIG;break;case"win_mega":case"common_win3":n=e.RESOURCE_PATHS.SFX_WIN_MEGA;break;default:n="audio/"+o}this.playSFX(n,i)},s.setSfxVolume=function(o){var i=Math.max(0,Math.min(1,o));this.ensureSfxPoolInitialized(),this.sfxAudioSource&&(this.sfxAudioSource.volume=i);for(var n,t=e(this._sfxPool);!(n=t()).done;){n.value.volume=i}m.instance&&(m.instance.sfxVolume=i)},s.getSfxVolume=function(){return this.sfxAudioSource?this.sfxAudioSource.volume:0},s.stopAllSFX=function(){this.ensureSfxPoolInitialized(),this.sfxAudioSource&&this.sfxAudioSource.playing&&this.sfxAudioSource.stop();for(var o,i=e(this._sfxPool);!(o=i()).done;){var n=o.value;n.playing&&n.stop()}},s.playSFXWithDucking=function(o,i,e,n){void 0===i&&(i=1),void 0===e&&(e=.5),void 0===n&&(n=.3);var t=m.instance;if(t&&t.sfxEnabled){if(this.bgmAudioSource&&this.bgmAudioSource.playing&&t.bgmEnabled){var u=this.bgmAudioSource.volume,a=u*(1-e);d(this.bgmAudioSource).to(.1,{volume:a}).delay(n).to(.2,{volume:u}).start()}this.playSFX(o,i)}},s.getAvailableSfxSource=function(){this.ensureSfxPoolInitialized();for(var o,i=e(this._sfxPool);!(o=i()).done;){var n=o.value;if(!n.playing)return n}return this.sfxAudioSource},s.loadAudioClip=function(o,i){var e=this;if(this._audioClipCache||(this._audioClipCache=new Map),this._audioClipCache.has(o)){var n=this._audioClipCache.get(o);return console.log("Using cached audio clip: "+o),void i(n)}console.log("Loading audio clip: "+o),h.load(o,f,(function(n,t){var u,a;if(n)return console.error("Failed to load audio: "+o,n),void i(null);if(!t)return console.error("Audio clip is null: "+o),void i(null);e._audioClipCache.set(o,t);var s=null!=(u=null!=(a=null==t?void 0:t.duration)?a:null==t||null==t.getDuration?void 0:t.getDuration())?u:"unknown";console.log("Audio clip loaded and cached: "+o+" (duration: "+s+"s)"),i(t)}))},s.loadAudioClipAsync=function(o){var i=this;return new Promise((function(e){i.loadAudioClip(o,(function(o){e(o)}))}))},s.isAudioCached=function(o){return this._audioClipCache.has(o)},s.getCachedAudio=function(o){return this._audioClipCache.get(o)||null},s.removeFromCache=function(o){this._audioClipCache.has(o)&&(this._audioClipCache.delete(o),console.log("Removed from cache: "+o))},s.preloadAudio=function(){var o=t(u().mark((function o(i){var e,n,t,a,s=this;return u().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return console.log("Preloading "+i.length+" audio clips..."),e=i.map((function(o){return s.loadAudioClipAsync(o)})),o.next=4,Promise.all(e);case 4:n=o.sent,t=n.filter((function(o){return null!==o})).length,a=n.length-t,console.log("Preload complete: "+t+" succeeded, "+a+" failed");case 8:case"end":return o.stop()}}),o)})));return function(i){return o.apply(this,arguments)}}(),s.preloadAllGameAudio=function(){var o=t(u().mark((function o(){var i,e;return u().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=g.instance,e=[i.RESOURCE_PATHS.BGM_MAIN,i.RESOURCE_PATHS.SFX_BUTTON,i.RESOURCE_PATHS.SFX_SCRATCH,i.RESOURCE_PATHS.SFX_SHOW1,i.RESOURCE_PATHS.SFX_SHOW2,i.RESOURCE_PATHS.SFX_WIN_SMALL,i.RESOURCE_PATHS.SFX_WIN_BIG,i.RESOURCE_PATHS.SFX_WIN_MEGA],o.next=4,this.preloadAudio(e);case 4:case"end":return o.stop()}}),o,this)})));return function(){return o.apply(this,arguments)}}(),s.clearCache=function(){this._audioClipCache.clear(),console.log("Audio cache cleared")},n(a,null,[{key:"instance",get:function(){return a._instance}}]),a}(S))._instance=null,A=p))||A);a._RF.pop()}}}));

System.register("chunks:///_virtual/BalanceView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameEvents.ts","./GameManager.ts"],(function(e){var a,n,t,i,r,l,o,c,s,u,f,p,b;return{setters:[function(e){a=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.createClass,i=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){l=e.cclegacy,o=e._decorator,c=e.Label,s=e.tween,u=e.Component},function(e){f=e.EventManager},function(e){p=e.GameEvents},function(e){b=e.GameManager}],execute:function(){var h,B,d,m,g,v,y,w,x,L,z,A,D,_,C,E,T;l._RF.push({},"b1a2cPU5fZ4kBI0VniQ/ty6","BalanceView",void 0);var P=o.ccclass,S=o.property;e("BalanceView",(h=P("BalanceView"),B=S(c),d=S({tooltip:'Prefix text before balance (e.g., "Balance: ", "$", "ðŸ’° ")'}),m=S({tooltip:'Suffix text after balance (e.g., " USD", " coins")'}),g=S({tooltip:"Number of decimal places to show"}),v=S({tooltip:"Enable animation when balance changes"}),y=S({tooltip:"Animation duration in seconds"}),w=S({tooltip:"Use thousand separators (e.g., 10,000.00)"}),h((z=a((L=function(e){function a(){for(var a,n=arguments.length,t=new Array(n),l=0;l<n;l++)t[l]=arguments[l];return a=e.call.apply(e,[this].concat(t))||this,i(a,"balanceLabel",z,r(a)),i(a,"prefix",A,r(a)),i(a,"suffix",D,r(a)),i(a,"decimalPlaces",_,r(a)),i(a,"enableAnimation",C,r(a)),i(a,"animationDuration",E,r(a)),i(a,"useThousandSeparator",T,r(a)),a._currentBalance=0,a}n(a,e);var l=a.prototype;return l.onLoad=function(){f.instance.on(p.BALANCE_CHANGED,this.onBalanceChanged,this)},l.onEnable=function(){var e;this.updateBalance((null==(e=b.instance)?void 0:e.currentBalance)||0,!1)},l.onDestroy=function(){f.instance.targetOff(this)},l.onBalanceChanged=function(e){this.updateBalance(e.newBalance,this.enableAnimation)},l.updateBalance=function(e,a){if(void 0===a&&(a=!0),this.balanceLabel){var n=this._currentBalance;this._currentBalance=e,a&&n!==e?this.animateBalanceChange(n,e):this.setBalanceText(e)}else console.warn("[BalanceView] Balance label not assigned!")},l.animateBalanceChange=function(e,a){var n=this;if(this.balanceLabel){var t=this.node.scale.clone();s(this.node).to(.1,{scale:t.clone().multiplyScalar(1.1)}).to(.2,{scale:t}).start();var i=this.animationDuration,r=(a-e)/20,l=0,o=setInterval((function(){l++;var t=e+r*l;l>=20?(n.setBalanceText(a),clearInterval(o)):n.setBalanceText(t)}),1e3*(i/20))}},l.setBalanceText=function(e){if(this.balanceLabel){var a=e.toFixed(this.decimalPlaces);if(this.useThousandSeparator){var n=a.split(".");n[0]=n[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),a=n.join(".")}this.balanceLabel.string=""+this.prefix+a+this.suffix}},l.setBalance=function(e){this.updateBalance(e,this.enableAnimation)},t(a,[{key:"currentBalance",get:function(){return this._currentBalance}}]),a}(u)).prototype,"balanceLabel",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=a(L.prototype,"prefix",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$"}}),D=a(L.prototype,"suffix",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),_=a(L.prototype,"decimalPlaces",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),C=a(L.prototype,"enableAnimation",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),E=a(L.prototype,"animationDuration",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.3}}),T=a(L.prototype,"useThousandSeparator",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),x=L))||x));l._RF.pop()}}}));

System.register("chunks:///_virtual/ButtonBuy.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./EventManager.ts","./GameEvents.ts"],(function(t){var n,e,o,u,a,i,s,c,r,l,B,y;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,o=t.initializerDefineProperty,u=t.assertThisInitialized},function(t){a=t.cclegacy,i=t._decorator,s=t.Button,c=t.Component},function(t){r=t.GameManager,l=t.GameState},function(t){B=t.EventManager},function(t){y=t.GameEvents}],execute:function(){var f,b,d,h,g;a._RF.push({},"2eae2YrIiRFIq8R58aUxNpo","ButtonBuy",void 0);var p=i.ccclass,v=i.property;t("ButtonBuy",(f=p("ButtonBuy"),b=v(s),f((g=n((h=function(t){function n(){for(var n,e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return n=t.call.apply(t,[this].concat(a))||this,o(n,"buyButton",g,u(n)),n}e(n,t);var a=n.prototype;return a.onLoad=function(){B.instance?(B.instance.on(y.ROUND_ENDED,this.onRoundEnded,this),B.instance.on(y.GAME_STATE_CHANGED,this.onGameStateChanged,this),console.log("[ButtonBuy] Event listeners registered")):console.warn("[ButtonBuy] EventManager not available")},a.onDestroy=function(){this.buyButton&&this.buyButton.node.off(s.EventType.CLICK,this.onBuyButtonClicked,this),B.instance&&(B.instance.targetOff(this),console.log("[ButtonBuy] Event listeners cleaned up"))},a.onBuyButtonClicked=function(){var t=r.instance;if(t){if(t.currentBalance<t.currentBet)return console.warn("[ButtonBuy] Insufficient balance for bet"),void this.showInsufficientBalanceEffect();this.disableButton(),t.startNewGame()}else console.warn("[ButtonBuy] GameManager not available")},a.disableButton=function(){this.buyButton&&(this.buyButton.interactable=!1,console.log("[ButtonBuy] Button disabled"))},a.enableButton=function(){this.buyButton&&(this.buyButton.interactable=!0,console.log("[ButtonBuy] Button enabled"))},a.onRoundEnded=function(t){console.log("[ButtonBuy] Round ended, re-enabling button"),this.enableButton()},a.onGameStateChanged=function(t){t.newState===l.READY&&(console.log("[ButtonBuy] Game state changed to READY, re-enabling button"),this.enableButton())},a.showInsufficientBalanceEffect=function(){var t=this;if(this.buyButton){var n=this.buyButton.node.scale.clone();this.buyButton.node.setScale(n.multiplyScalar(.95)),this.scheduleOnce((function(){t.buyButton&&t.buyButton.node.isValid&&t.buyButton.node.setScale(n)}),.1)}},n}(c)).prototype,"buyButton",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=h))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/CostToPlayView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./EventManager.ts","./GameEvents.ts","./GameManager.ts"],(function(e){var t,n,i,a,o,r,l,s,c,u,f,b,p,h;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.createClass,a=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,l=e._decorator,s=e.Label,c=e.Color,u=e.tween,f=e.Component},function(e){b=e.EventManager},function(e){p=e.GameEvents},function(e){h=e.GameManager}],execute:function(){var d,y,C,g,m,w,B,A,v,_,x,L,z,D,P,T,E,S,G,V,k,M,W,N,F;r._RF.push({},"c1d2eP0pbZ4kBI0VniQq83v","CostToPlayView",void 0);var H=l.ccclass,j=l.property;e("CostToPlayView",(d=H("CostToPlayView"),y=j(s),C=j({tooltip:'Prefix text before cost (e.g., "Bet: ", "Cost: ", "ðŸ’° ")'}),g=j({tooltip:'Suffix text after cost (e.g., " per play")'}),m=j({tooltip:"Number of decimal places to show"}),w=j({tooltip:"Use thousand separators (e.g., 1,000)"}),B=j({tooltip:"Enable color change based on affordability"}),A=j({type:c,tooltip:"Color when player can afford the bet",visible:function(){return this.enableAffordabilityColor}}),v=j({type:c,tooltip:"Color when player cannot afford the bet",visible:function(){return this.enableAffordabilityColor}}),_=j({type:c,tooltip:"Default color when affordability check is disabled",visible:function(){return!this.enableAffordabilityColor}}),x=j({tooltip:"Enable animation when cost changes"}),L=j({tooltip:"Show warning animation when unaffordable"}),d((P=t((D=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i))||this,a(t,"costLabel",P,o(t)),a(t,"prefix",T,o(t)),a(t,"suffix",E,o(t)),a(t,"decimalPlaces",S,o(t)),a(t,"useThousandSeparator",G,o(t)),a(t,"enableAffordabilityColor",V,o(t)),a(t,"affordableColor",k,o(t)),a(t,"unaffordableColor",M,o(t)),a(t,"defaultColor",W,o(t)),a(t,"enableAnimation",N,o(t)),a(t,"enableWarningAnimation",F,o(t)),t._currentBet=0,t._currentBalance=0,t}n(t,e);var r=t.prototype;return r.onLoad=function(){b.instance.on(p.BET_CHANGED,this.onBetChanged,this),b.instance.on(p.BALANCE_CHANGED,this.onBalanceChanged,this)},r.onEnable=function(){var e=h.instance;e&&(this._currentBet=e.currentBet,this._currentBalance=e.currentBalance,this.updateDisplay())},r.onDestroy=function(){b.instance.targetOff(this)},r.onBetChanged=function(e){this._currentBet=e.newBet,this.updateDisplay(!0)},r.onBalanceChanged=function(e){this._currentBalance=e.newBalance,this.updateDisplay(!1)},r.updateDisplay=function(e){void 0===e&&(e=!1),this.costLabel?(this.updateCostText(),this.updateAffordabilityColor(),e&&this.enableAnimation&&this.animateCostChange()):console.warn("[CostToPlayView] Cost label not assigned!")},r.updateCostText=function(){if(this.costLabel){var e=this._currentBet.toFixed(this.decimalPlaces);if(this.useThousandSeparator){var t=e.split(".");t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e=t.join(".")}this.costLabel.string=""+this.prefix+e+this.suffix}},r.updateAffordabilityColor=function(){if(this.costLabel&&this.enableAffordabilityColor){var e=this._currentBalance>=this._currentBet,t=e?this.affordableColor:this.unaffordableColor;u(this.costLabel).to(.2,{color:t}).start(),!e&&this.enableWarningAnimation&&this.playWarningAnimation()}else this.costLabel&&!this.enableAffordabilityColor&&(this.costLabel.color=this.defaultColor)},r.animateCostChange=function(){var e=this.node.scale.clone();u(this.node).to(.1,{scale:e.clone().multiplyScalar(1.2)}).to(.2,{scale:e}).start()},r.playWarningAnimation=function(){var e=this.node.scale.clone();u(this.node).to(.1,{scale:e.clone().multiplyScalar(1.1)}).to(.1,{scale:e.clone().multiplyScalar(.9)}).to(.1,{scale:e.clone().multiplyScalar(1.1)}).to(.1,{scale:e}).start()},r.setBet=function(e){this._currentBet=e,this.updateDisplay(!0)},i(t,[{key:"canAfford",get:function(){return this._currentBalance>=this._currentBet}},{key:"currentBet",get:function(){return this._currentBet}}]),t}(f)).prototype,"costLabel",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(D.prototype,"prefix",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Bet: $"}}),E=t(D.prototype,"suffix",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),S=t(D.prototype,"decimalPlaces",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G=t(D.prototype,"useThousandSeparator",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),V=t(D.prototype,"enableAffordabilityColor",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),k=t(D.prototype,"affordableColor",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(0,255,0,255)}}),M=t(D.prototype,"unaffordableColor",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(255,0,0,255)}}),W=t(D.prototype,"defaultColor",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new c(255,255,255,255)}}),N=t(D.prototype,"enableAnimation",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),F=t(D.prototype,"enableWarningAnimation",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),z=D))||z));r._RF.pop()}}}));

System.register("chunks:///_virtual/debug-view-runtime-control.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,o,i,n,s,l,r,a,g,h,p,c,C,d,m,u,L;return{setters:[function(t){e=t.applyDecoratedDescriptor,o=t.inheritsLoose,i=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){s=t.cclegacy,l=t._decorator,r=t.Node,a=t.Canvas,g=t.UITransform,h=t.instantiate,p=t.Label,c=t.Color,C=t.RichText,d=t.Toggle,m=t.Button,u=t.director,L=t.Component}],execute:function(){var f,M,b,v,T,S,x,E,I;s._RF.push({},"b2bd1+njXxJxaFY3ymm06WU","debug-view-runtime-control",void 0);var A=l.ccclass,y=l.property;t("DebugViewRuntimeControl",(f=A("internal.DebugViewRuntimeControl"),M=y(r),b=y(r),v=y(r),f((x=e((S=function(t){function e(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(e,"compositeModeToggle",x,n(e)),i(e,"singleModeToggle",E,n(e)),i(e,"EnableAllCompositeModeButton",I,n(e)),e._single=0,e.strSingle=["No Single Debug","Vertex Color","Vertex Normal","Vertex Tangent","World Position","Vertex Mirror","Face Side","UV0","UV1","UV Lightmap","Project Depth","Linear Depth","Fragment Normal","Fragment Tangent","Fragment Binormal","Base Color","Diffuse Color","Specular Color","Transparency","Metallic","Roughness","Specular Intensity","IOR","Direct Diffuse","Direct Specular","Direct All","Env Diffuse","Env Specular","Env All","Emissive","Light Map","Shadow","AO","Fresnel","Direct Transmit Diffuse","Direct Transmit Specular","Env Transmit Diffuse","Env Transmit Specular","Transmit All","Direct Internal Specular","Env Internal Specular","Internal All","Fog"],e.strComposite=["Direct Diffuse","Direct Specular","Env Diffuse","Env Specular","Emissive","Light Map","Shadow","AO","Normal Map","Fog","Tone Mapping","Gamma Correction","Fresnel","Transmit Diffuse","Transmit Specular","Internal Specular","TT"],e.strMisc=["CSM Layer Coloration","Lighting With Albedo"],e.compositeModeToggleList=[],e.singleModeToggleList=[],e.miscModeToggleList=[],e.textComponentList=[],e.labelComponentList=[],e.textContentList=[],e.hideButtonLabel=void 0,e._currentColorIndex=0,e.strColor=["<color=#ffffff>","<color=#000000>","<color=#ff0000>","<color=#00ff00>","<color=#0000ff>"],e.color=[c.WHITE,c.BLACK,c.RED,c.GREEN,c.BLUE],e}o(e,t);var s=e.prototype;return s.start=function(){if(this.node.parent.getComponent(a)){var t=this.node.parent.getComponent(g),e=.5*t.width,o=.5*t.height,i=.1*e-e,n=o-.1*o,s=this.node.getChildByName("MiscMode"),l=h(s);l.parent=this.node,l.name="Buttons";var r=h(s);r.parent=this.node,r.name="Titles";for(var u=0;u<2;u++){var L=h(this.EnableAllCompositeModeButton.getChildByName("Label"));L.setPosition(i+(u>0?450:150),n,0),L.setScale(.75,.75,.75),L.parent=r;var f=L.getComponent(p);f.string=u?"----------Composite Mode----------":"----------Single Mode----------",f.color=c.WHITE,f.overflow=0,this.labelComponentList[this.labelComponentList.length]=f}n-=20;for(var M=0,b=0;b<this.strSingle.length;b++,M++){b===this.strSingle.length>>1&&(i+=200,M=0);var v=b?h(this.singleModeToggle):this.singleModeToggle;v.setPosition(i,n-20*M,0),v.setScale(.5,.5,.5),v.parent=this.singleModeToggle.parent;var T=v.getComponentInChildren(C);T.string=this.strSingle[b],this.textComponentList[this.textComponentList.length]=T,this.textContentList[this.textContentList.length]=T.string,v.on(d.EventType.TOGGLE,this.toggleSingleMode,this),this.singleModeToggleList[b]=v}i+=200,this.EnableAllCompositeModeButton.setPosition(i+15,n,0),this.EnableAllCompositeModeButton.setScale(.5,.5,.5),this.EnableAllCompositeModeButton.on(m.EventType.CLICK,this.enableAllCompositeMode,this),this.EnableAllCompositeModeButton.parent=l;var S=this.EnableAllCompositeModeButton.getComponentInChildren(p);this.labelComponentList[this.labelComponentList.length]=S;var x=h(this.EnableAllCompositeModeButton);x.setPosition(i+90,n,0),x.setScale(.5,.5,.5),x.on(m.EventType.CLICK,this.changeTextColor,this),x.parent=l,(S=x.getComponentInChildren(p)).string="TextColor",this.labelComponentList[this.labelComponentList.length]=S;var E=h(this.EnableAllCompositeModeButton);E.setPosition(i+200,n,0),E.setScale(.5,.5,.5),E.on(m.EventType.CLICK,this.hideUI,this),E.parent=this.node.parent,(S=E.getComponentInChildren(p)).string="Hide UI",this.labelComponentList[this.labelComponentList.length]=S,this.hideButtonLabel=S,n-=40;for(var I=0;I<this.strMisc.length;I++){var A=h(this.compositeModeToggle);A.setPosition(i,n-20*I,0),A.setScale(.5,.5,.5),A.parent=s;var y=A.getComponentInChildren(C);y.string=this.strMisc[I],this.textComponentList[this.textComponentList.length]=y,this.textContentList[this.textContentList.length]=y.string,A.getComponent(d).isChecked=!!I,A.on(d.EventType.TOGGLE,I?this.toggleLightingWithAlbedo:this.toggleCSMColoration,this),this.miscModeToggleList[I]=A}n-=150;for(var D=0;D<this.strComposite.length;D++){var B=D?h(this.compositeModeToggle):this.compositeModeToggle;B.setPosition(i,n-20*D,0),B.setScale(.5,.5,.5),B.parent=this.compositeModeToggle.parent;var w=B.getComponentInChildren(C);w.string=this.strComposite[D],this.textComponentList[this.textComponentList.length]=w,this.textContentList[this.textContentList.length]=w.string,B.on(d.EventType.TOGGLE,this.toggleCompositeMode,this),this.compositeModeToggleList[D]=B}}else console.error("debug-view-runtime-control should be child of Canvas")},s.isTextMatched=function(t,e){var o=new String(t),i=o.search(">");return-1===i?t===e:(o=(o=o.substr(i+1)).substr(0,o.search("<")))===e},s.toggleSingleMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strSingle.length;i++)this.isTextMatched(o.string,this.strSingle[i])&&(e.singleMode=i)},s.toggleCompositeMode=function(t){for(var e=u.root.debugView,o=t.getComponentInChildren(C),i=0;i<this.strComposite.length;i++)this.isTextMatched(o.string,this.strComposite[i])&&e.enableCompositeMode(i,t.isChecked)},s.toggleLightingWithAlbedo=function(t){u.root.debugView.lightingWithAlbedo=t.isChecked},s.toggleCSMColoration=function(t){u.root.debugView.csmLayerColoration=t.isChecked},s.enableAllCompositeMode=function(t){var e=u.root.debugView;e.enableAllCompositeMode(!0);for(var o=0;o<this.compositeModeToggleList.length;o++){this.compositeModeToggleList[o].getComponent(d).isChecked=!0}var i=this.miscModeToggleList[0].getComponent(d);i.isChecked=!1,e.csmLayerColoration=!1,(i=this.miscModeToggleList[1].getComponent(d)).isChecked=!0,e.lightingWithAlbedo=!0},s.hideUI=function(t){var e=this.node.getChildByName("Titles"),o=!e.active;this.singleModeToggleList[0].parent.active=o,this.miscModeToggleList[0].parent.active=o,this.compositeModeToggleList[0].parent.active=o,this.EnableAllCompositeModeButton.parent.active=o,e.active=o,this.hideButtonLabel.string=o?"Hide UI":"Show UI"},s.changeTextColor=function(t){this._currentColorIndex++,this._currentColorIndex>=this.strColor.length&&(this._currentColorIndex=0);for(var e=0;e<this.textComponentList.length;e++)this.textComponentList[e].string=this.strColor[this._currentColorIndex]+this.textContentList[e]+"</color>";for(var o=0;o<this.labelComponentList.length;o++)this.labelComponentList[o].color=this.color[this._currentColorIndex]},s.onLoad=function(){},s.update=function(t){},e}(L)).prototype,"compositeModeToggle",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(S.prototype,"singleModeToggle",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=e(S.prototype,"EnableAllCompositeModeButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=S))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/Dust.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var i,e,a,n,r,o,l,s,p,u,c,h,f;return{setters:[function(t){i=t.applyDecoratedDescriptor,e=t.inheritsLoose,a=t.initializerDefineProperty,n=t.assertThisInitialized},function(t){r=t.cclegacy,o=t._decorator,l=t.UIOpacity,s=t.UITransform,p=t.Tween,u=t.randomRange,c=t.tween,h=t.Vec3,f=t.Component}],execute:function(){var y,m,d,b,g,_,w,T,A,z,D,v,S,B,F,x,C,O,R,k,M,N,W,I,Y,P,U;r._RF.push({},"6819b7nU2ZGcbmwrr9Bpd/k","Dust",void 0);var V=o.ccclass,q=o.property;t("Dust",(y=V("Dust"),m=q({type:Number,tooltip:"Min fall duration in seconds"}),d=q({type:Number,tooltip:"Max fall duration in seconds"}),b=q({type:Number,tooltip:"Horizontal drift amount (aggressive)"}),g=q({type:Number,tooltip:"Horizontal drift variation (adds unpredictability)"}),_=q({type:Number,tooltip:"Swaying amplitude (left-right oscillation)"}),w=q({type:Number,tooltip:"Swaying frequency (how many sways during fall)"}),T=q({type:Number,tooltip:"Y position where dust disappears"}),A=q({type:Boolean,tooltip:"Enable fade out"}),z=q({type:Boolean,tooltip:"Enable width scaling (paper flip effect)"}),D=q({type:Number,tooltip:"Min scale multiplier"}),v=q({type:Number,tooltip:"Max scale multiplier"}),S=q({type:Number,tooltip:"Spawn position random offset range"}),y((x=i((F=function(t){function i(){for(var i,e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return i=t.call.apply(t,[this].concat(r))||this,a(i,"minFallDuration",x,n(i)),a(i,"maxFallDuration",C,n(i)),a(i,"horizontalDrift",O,n(i)),a(i,"horizontalDriftVariation",R,n(i)),a(i,"swayAmplitude",k,n(i)),a(i,"swayFrequency",M,n(i)),a(i,"disappearY",N,n(i)),a(i,"enableFadeOut",W,n(i)),a(i,"enableWidthScaling",I,n(i)),a(i,"minScale",Y,n(i)),a(i,"maxScale",P,n(i)),a(i,"spawnOffsetRange",U,n(i)),i._opacity=null,i._uiTransform=null,i._isAnimating=!1,i._checkInterval=.016,i._recycleCallback=null,i._originalWidth=0,i}e(i,t);var r=i.prototype;return r.onLoad=function(){this.enableFadeOut&&(this._opacity=this.node.getComponent(l),this._opacity||(this._opacity=this.node.addComponent(l)),this._opacity.opacity=255),this._uiTransform=this.node.getComponent(s),this._uiTransform||(this._uiTransform=this.node.addComponent(s)),this._uiTransform&&(this._originalWidth=this._uiTransform.width)},r.fall=function(t){var i=this;p.stopAllByTarget(this.node),this._opacity&&p.stopAllByTarget(this._opacity),this._uiTransform&&p.stopAllByTarget(this._uiTransform),this._recycleCallback=t,this._isAnimating=!0;var e=u(this.minFallDuration,this.maxFallDuration),a=this.node.position.clone(),n=this.disappearY,r=Math.random()>.5,o=u(20,180)*(Math.random()>.5?1:-1),l=a.x+o,s=r?u(.5*this.swayAmplitude,this.swayAmplitude):0,h=r?u(2,5):0,f=u(0,2*Math.PI);if(c({progress:0}).to(e,{progress:1},{easing:"linear",onUpdate:function(t,e){if(i.node&&i.node.isValid){var o=t.progress,p=a.y+(n-a.y)*o,u=r?Math.sin(o*h*Math.PI*2+f)*s:0,c=a.x+(l-a.x)*o+u;i.node.setPosition(c,p,0)}}}).call((function(){if(i._isAnimating=!1,i._recycleCallback){var t=i._recycleCallback;i._recycleCallback=null,t()}})).start(),this.enableWidthScaling&&this._uiTransform&&this._originalWidth>0){for(var y=Math.floor(u(1,6)),m=u(.8,2),d=u(.1,.5),b=c(this._uiTransform),g=0;g<y;g++){var _=e/(2*y)*m;b=b.to(_,{width:this._originalWidth*d}).to(_,{width:this._originalWidth})}b.start()}return this.enableFadeOut&&this._opacity&&c(this._opacity).delay(.7*e).to(.3*e,{opacity:0}).start(),e},r.stopAllTweens=function(){p.stopAllByTarget(this.node),this._opacity&&p.stopAllByTarget(this._opacity),this._uiTransform&&p.stopAllByTarget(this._uiTransform),this._recycleCallback=null},r.applyRandomScale=function(){var t=u(this.minScale,this.maxScale);this.node.setScale(new h(t,t,1))},r.applyRandomSpawnOffset=function(t){var i=u(-this.spawnOffsetRange,this.spawnOffsetRange),e=u(-this.spawnOffsetRange,this.spawnOffsetRange);return new h(t.x+i,t.y+e,0)},r.reset=function(){p.stopAllByTarget(this.node),this._opacity&&p.stopAllByTarget(this._opacity),this._uiTransform&&p.stopAllByTarget(this._uiTransform),this.node.angle=0,this._isAnimating=!1,this._recycleCallback=null,this.node.setScale(h.ONE.clone()),this._opacity&&(this._opacity.opacity=255),this._uiTransform&&this._originalWidth>0&&(this._uiTransform.width=this._originalWidth)},r.hasReachedDisappearY=function(){return this.node.position.y<=this.disappearY},r.onDestroy=function(){p.stopAllByTarget(this.node),this._opacity&&p.stopAllByTarget(this._opacity),this._uiTransform&&p.stopAllByTarget(this._uiTransform),this._recycleCallback=null},i}(f)).prototype,"minFallDuration",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),C=i(F.prototype,"maxFallDuration",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2.5}}),O=i(F.prototype,"horizontalDrift",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 120}}),R=i(F.prototype,"horizontalDriftVariation",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),k=i(F.prototype,"swayAmplitude",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),M=i(F.prototype,"swayFrequency",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4}}),N=i(F.prototype,"disappearY",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-800}}),W=i(F.prototype,"enableFadeOut",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=i(F.prototype,"enableWidthScaling",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),Y=i(F.prototype,"minScale",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.8}}),P=i(F.prototype,"maxScale",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2.2}}),U=i(F.prototype,"spawnOffsetRange",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),B=F))||B));r._RF.pop()}}}));

System.register("chunks:///_virtual/EventManager.ts",["cc","./Singleton.ts"],(function(t){var n,e,r;return{setters:[function(t){n=t.cclegacy,e=t.EventTarget},function(t){r=t.singleton}],execute:function(){var i,o;n._RF.push({},"002a2wY3YBNPIr35qonBJ8/","EventManager",void 0);t("EventManager",r(((o=function(){function t(){this._eventTarget=void 0,this._eventTarget=new e}var n=t.prototype;return n.on=function(t,n,e,r){return this._eventTarget.on(t,n,e,r)},n.once=function(t,n,e){return this._eventTarget.once(t,n,e)},n.off=function(t,n,e){return this._eventTarget.off(t,n,e)},n.targetOff=function(t){this._eventTarget.targetOff(t)},n.emit=function(t){for(var n,e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return(n=this._eventTarget).emit.apply(n,[t].concat(r))},t}()).instance=void 0,i=o))||i);n._RF.pop()}}}));

System.register("chunks:///_virtual/GameConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(_){var i,t,s;return{setters:[function(_){i=_.createClass},function(_){t=_.cclegacy,s=_._decorator}],execute:function(){var e,A;t._RF.push({},"a1b2cPU5fZ4kKvN7xI0VniQ","GameConfig",void 0);var E=s.ccclass,u=_("GameConfig",E("GameConfig")(((A=function(){function _(){this.GAME_VERSION="1.0.0",this.GAME_NAME="Labubu Lucky Pop",this.BET_AMOUNTS=[1,5,10,25,50,100,250,500,1e3],this.DEFAULT_BET_INDEX=2,this.STARTING_BALANCE=1e4,this.MIN_BALANCE=1,this.MAX_BALANCE=1e6,this.PRIZE_SLOTS_COUNT=9,this.MIN_MATCHING_SYMBOLS=3,this.PAYLINES=[{positions:[0,1,2],multiplier:7},{positions:[3,4,5],multiplier:30},{positions:[6,7,8],multiplier:1},{positions:[0,3,6],multiplier:3},{positions:[1,4,7],multiplier:300},{positions:[2,5,8],multiplier:1},{positions:[0,4,8],multiplier:3333},{positions:[2,4,6],multiplier:3333}],this.PRIZE_PROBABILITIES={LABUBU_SMALL:15,LABUBU_MEDIUM:10,LABUBU_LARGE:5,COIN_SMALL:20,COIN_MEDIUM:15,COIN_LARGE:10,MULTIPLIER_2X:12,MULTIPLIER_5X:8,MULTIPLIER_10X:5},this.PRIZE_MULTIPLIERS={LABUBU_SMALL:.5,LABUBU_MEDIUM:2,LABUBU_LARGE:10,COIN_SMALL:.2,COIN_MEDIUM:1,COIN_LARGE:5,MULTIPLIER_2X:2,MULTIPLIER_5X:5,MULTIPLIER_10X:10},this.WIN_PROBABILITY=30,this.BIG_WIN_THRESHOLD=5,this.MEGA_WIN_THRESHOLD=10,this.SCRATCH_BRUSH_SIZE=30,this.SCRATCH_REVEAL_THRESHOLD=60,this.SCRATCH_ANIMATION_DURATION=.3,this.DEFAULT_BGM_VOLUME=.5,this.DEFAULT_SFX_VOLUME=.8,this.AUDIO_ENABLED_DEFAULT=!0,this.BGM_ENABLED_DEFAULT=!0,this.SFX_ENABLED_DEFAULT=!0,this.WIN_ANIMATION_DURATION=2,this.TICKET_APPEAR_DURATION=.5,this.AUTO_REVEAL_DURATION=1,this.PRIZE_HIGHLIGHT_DURATION=.3,this.PRIZE_HIGHLIGHT_REPEAT=3,this.AUTO_PLAY_SPEED_MIN=.5,this.AUTO_PLAY_SPEED_MAX=2.5,this.AUTO_PLAY_SPEED_DEFAULT=1,this.AUTO_PLAY_DELAY=1,this.AUTO_PLAY_MAX_ROUNDS=100,this.LOADING_MIN_DURATION=1,this.POPUP_FADE_DURATION=.3,this.TOAST_DURATION=2,this.WIN_POPUP_DURATION=3,this.SCRATCH_START_DELAY=1,this.REVEAL_DELAY=.5,this.READY_STATE_DELAY=1,this.STORAGE_KEYS={BALANCE:"labubu_balance",CURRENT_BET:"labubu_current_bet",BGM_VOLUME:"labubu_bgm_volume",SFX_VOLUME:"labubu_sfx_volume",BGM_ENABLED:"labubu_bgm_enabled",SFX_ENABLED:"labubu_sfx_enabled",AUTO_PLAY_SPEED:"labubu_auto_play_speed",TOTAL_GAMES_PLAYED:"labubu_total_games",TOTAL_WINS:"labubu_total_wins",TOTAL_WINNINGS:"labubu_total_winnings",BIGGEST_WIN:"labubu_biggest_win",GAME_HISTORY:"labubu_game_history"},this.RESOURCE_PATHS={DUST_EFFECT:"effects/scratch_dust",SCRATCH_MASK:"textures/scratch_mask",LABUBU_SMALL:"textures/prizes/labubu_small",LABUBU_MEDIUM:"textures/prizes/labubu_medium",LABUBU_LARGE:"textures/prizes/labubu_large",COIN_SMALL:"textures/prizes/coin_small",COIN_MEDIUM:"textures/prizes/coin_medium",COIN_LARGE:"textures/prizes/coin_large",MULTIPLIER_2X:"textures/prizes/multiplier_2x",MULTIPLIER_5X:"textures/prizes/multiplier_5x",MULTIPLIER_10X:"textures/prizes/multiplier_10x",BGM_MAIN:"audio/music/bgm",SFX_BUTTON:"audio/sfx/button",SFX_SCRATCH:"audio/sfx/Scratch",SFX_SHOW1:"audio/sfx/Show1",SFX_SHOW2:"audio/sfx/Show2",SFX_SHOW3:"audio/sfx/Show3",SFX_WIN_SMALL:"audio/sfx/Common_Win1",SFX_WIN_BIG:"audio/sfx/Common_Win2",SFX_WIN_MEGA:"audio/sfx/Common_Win3",SFX_WIN_SUPER:"audio/sfx/win_super",SFX_WIN_111:"audio/sfx/win111",SFX_BET_SUCCEED:"audio/sfx/BetSucceed",SFX_FAIL:"audio/sfx/Fail",SFX_GOLD:"audio/sfx/gold",SFX_NUMBER:"audio/sfx/number"}}var t=_.prototype;return t.getPrizeIconPath=function(_){var i=_.toUpperCase();return this.RESOURCE_PATHS[i]||""},t.getPrizeMultiplier=function(_){return this.PRIZE_MULTIPLIERS[_]||0},t.getPrizeProbability=function(_){return this.PRIZE_PROBABILITIES[_]||0},t.isValidBetAmount=function(_){return-1!==this.BET_AMOUNTS.indexOf(_)},t.getNextBetAmount=function(_){var i=this.BET_AMOUNTS.indexOf(_);return-1===i||i>=this.BET_AMOUNTS.length-1?_:this.BET_AMOUNTS[i+1]},t.getPreviousBetAmount=function(_){var i=this.BET_AMOUNTS.indexOf(_);return i<=0?_:this.BET_AMOUNTS[i-1]},i(_,[{key:"MIN_BET",get:function(){return this.BET_AMOUNTS[0]}},{key:"MAX_BET",get:function(){return this.BET_AMOUNTS[this.BET_AMOUNTS.length-1]}}],[{key:"instance",get:function(){return _._instance||(_._instance=new _),_._instance}}]),_}())._instance=null,e=A))||e);_("default",u.instance);t._RF.pop()}}}));

System.register("chunks:///_virtual/GameEvents.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"e1f2aO0xdZ4kBI0VniQq83v","GameEvents",void 0);var a=e("GameEvents",(function(){}));a.BALANCE_CHANGED="game:balance-changed",a.BET_CHANGED="game:bet-changed",a.GAME_STATE_CHANGED="game:state-changed",a.ROUND_STARTED="game:round-started",a.ROUND_ENDED="game:round-ended",a.SCRATCH_START="scratch:start",a.SCRATCH_PROGRESS="scratch:progress",a.SCRATCH_END="scratch:end",a.SCRATCH_THRESHOLD_REACHED="scratch:threshold-reached",a.SCRATCH_COMPLETE="scratch:complete",a.SCRATCH_ITEM_THRESHOLD_REACHED="scratch:item-threshold-reached",a.SCRATCH_SOUND="scratch:sound",a.GAME_RESULT_GENERATED="game:result-generated",a.WIN_AMOUNT_READY="game:win-amount-ready";e("ScratchQuality",function(e){return e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH",e}({}));t._RF.pop()}}}));

System.register("chunks:///_virtual/GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./SettingsManager.ts","./AudioManager.ts","./LocalGameController.ts","./EventManager.ts","./GameEvents.ts","./TicketGameController.ts"],(function(e){var t,n,a,i,r,o,s,l,c,u,g,h,m,f,G,_,d,S,y,A,p,M,E,C;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.createClass,i=e.initializerDefineProperty,r=e.assertThisInitialized,o=e.asyncToGenerator,s=e.regeneratorRuntime},function(e){l=e.cclegacy,c=e._decorator,u=e.Node,g=e.UITransform,h=e.resources,m=e.Prefab,f=e.instantiate,G=e.Vec3,_=e.tween,d=e.Component},function(e){S=e.GameConfig},function(e){y=e.SettingsManager},function(e){A=e.AudioManager},function(e){p=e.LocalGameController},function(e){M=e.EventManager},function(e){E=e.GameEvents},function(e){C=e.TicketGameController}],execute:function(){var b,L,v,N,w,B,R,D,k,I,P,T,O,W,z,F,U,Y;l._RF.push({},"5a55cpXe0lH7oyErk5iFC9u","GameManager",void 0);var H=c.ccclass,V=c.property,X=(e("GameManager",(b=H("GameManager"),L=V(u),v=V(u),N=V(u),w=V(y),B=V(A),R=V(p),D=V(C),b(((Y=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,i(t,"gameCanvas",P,r(t)),i(t,"uiLayer",T,r(t)),i(t,"gameLayer",O,r(t)),i(t,"settingsManager",W,r(t)),i(t,"audioManager",z,r(t)),i(t,"gameController",F,r(t)),i(t,"ticketGameController",U,r(t)),t._gameState=X.LOADING,t._currentBalance=S.instance.STARTING_BALANCE,t._currentBet=S.instance.BET_AMOUNTS[S.instance.DEFAULT_BET_INDEX],t._isAutoPlay=!1,t._gameSpeed=S.instance.AUTO_PLAY_SPEED_DEFAULT,t._lotteryPrefab=null,t._winPrefab=null,t._erasePrefab=null,t._currentLottery=null,t._tickets=[],t._lastGameResult=null,t}n(t,e);var l=t.prototype;return l.onLoad=function(){t.instance=this,this.initializeGame(),this.setupScratchCardEventListeners()},l.start=function(){this.loadGameAssets(),this.startBackgroundMusic()},l.onDestroy=function(){var e;null==(e=M.instance)||e.targetOff(this)},l.setupScratchCardEventListeners=function(){var e=M.instance;e?(e.on(E.SCRATCH_COMPLETE,this.onScratchComplete,this),e.on(E.SCRATCH_THRESHOLD_REACHED,(function(e){console.log("Scratch threshold reached at "+e.percentage.toFixed(1)+"%")}),this),e.on(E.WIN_AMOUNT_READY,this.onWinAmountReady,this),console.log("ScratchCard event listeners registered")):console.warn("EventManager not available")},l.onWinAmountReady=function(e){var t=this,n=this._currentBalance,a=n+e.winAmount;console.log("[GameManager] Updating balance: "+n+" + "+e.winAmount+" = "+a),this.currentBalance=a,this.scheduleOnce((function(){t.setGameState(X.READY),console.log("[GameManager] Game state set to READY - ready for next round")}),.6)},l.startBackgroundMusic=function(){var e=A.instance,t=y.instance;if(e&&t)if(t.bgmEnabled){var n=S.instance;e.playBGM(n.RESOURCE_PATHS.BGM_MAIN),console.log("ðŸŽµ Background music started from GameManager")}else console.log("Background music disabled in settings");else console.warn("âš ï¸ AudioManager or SettingsManager singleton not available"),console.warn("AudioManager.instance: "+e),console.warn("SettingsManager.instance: "+t)},l.initializeGame=function(){if(console.log("Initializing Labubu Lucky Pop game..."),this.gameCanvas){var e=this.gameCanvas.getComponent(g);e&&(e.setContentSize(750,1334),console.log("Canvas resolution set to 750x1334"))}else console.warn("âš ï¸ gameCanvas is not assigned in GameManager");this.settingsManager&&(this.settingsManager.loadSettings(),this.currentBalance=this.settingsManager.currentBalance,this.currentBet=this.settingsManager.currentBet),this.setGameState(X.MENU)},l.loadGameAssets=function(){var e=o(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{S.instance,console.log("Game assets loaded successfully"),this.setGameState(X.READY)}catch(e){console.error("Failed to load game assets:",e)}case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),l.loadPrefab=function(e){return new Promise((function(t,n){h.load(e,m,(function(e,a){e?n(e):t(a)}))}))},l.setGameState=function(e){var t=this._gameState;this._gameState=e,console.log("Game state changed: "+X[t]+" -> "+X[e]),M.instance.emit(E.GAME_STATE_CHANGED,{oldState:t,newState:e}),this.onGameStateChanged(t,e)},l.onGameStateChanged=function(e,t){switch(t){case X.LOADING:this.showLoadingScreen();break;case X.MENU:this.showMainMenu();break;case X.READY:var n;if(this.showGameScreen(),e!==X.LOADING&&e!==X.MENU)M.instance.emit(E.ROUND_ENDED,{winAmount:(null==(n=this._lastGameResult)?void 0:n.totalWin)||0,newBalance:this._currentBalance}),console.log("[GameManager] ROUND_ENDED event emitted");break;case X.PLAYING:this.startGameplay();break;case X.SCRATCHING:this.enableScratching();break;case X.REVEALING:this.revealResults();break;case X.WIN:this.showWinAnimation();break;case X.GAME_OVER:this.showGameOver()}},l.showLoadingScreen=function(){console.log("Showing loading screen...")},l.showMainMenu=function(){console.log("Showing main menu...")},l.showGameScreen=function(){console.log("Showing game screen...")},l.startNewGame=function(){if(this._gameState===X.READY)if(this.gameController){this.ticketGameController?(console.log("[GameManager] Calling ticketGameController.resetForNextGame()..."),this.ticketGameController.resetForNextGame(),console.log("[GameManager] TicketGameController reset completed")):console.error("[GameManager] ticketGameController is NULL - cannot reset!"),console.log("[GameManager] Starting new game with bet:",this._currentBet,"balance:",this._currentBalance);var e=this.gameController.playRound(this._currentBet,this._currentBalance);if(e.success){this._lastGameResult=e.result,console.log("[GameManager] Game result generated, now processing balance");var t=this._currentBalance,n=e.betAmount,a=t-n;console.log("[GameManager] Balance deduction:",t,"-",n,"=",a),this.currentBalance=a,this.createLotteryTicket(e.result),this.settingsManager&&this.settingsManager.recordGame(e.result.totalWin),this.setGameState(X.PLAYING)}else console.warn("Failed to play round:",e.error)}else console.error("LocalGameController not initialized");else console.warn("Cannot start game in current state:",X[this._gameState])},l.createLotteryTicket=function(e){if(this._lotteryPrefab){this._currentLottery&&this._currentLottery.destroy(),this._currentLottery=f(this._lotteryPrefab),this._currentLottery.setParent(this.gameLayer),this._currentLottery.setPosition(G.ZERO);var t=this._currentLottery.getComponent("LotteryTicket");t&&(null==t.setPrizeData||t.setPrizeData(e.prizes),console.log("Lottery ticket created with prizes:",e.prizes),null==t.initialize||t.initialize(this._currentBet))}else console.error("Lottery prefab not loaded")},l.startGameplay=function(){var e=this;console.log("Starting gameplay..."),this.playSFX("Show1"),this.scheduleOnce((function(){e.setGameState(X.SCRATCHING)}),1)},l.enableScratching=function(){if(console.log("Enabling scratching..."),this._currentLottery){var e=this._currentLottery.getComponent("ScratchCard");e&&(null==e.enableScratching||e.enableScratching())}},l.onScratchComplete=function(){console.log("Scratch complete, revealing results..."),this.setGameState(X.REVEALING)},l.revealResults=function(){if(!this._lastGameResult)return console.error("No game result available"),void this.setGameState(X.READY);var e=this._lastGameResult.totalWin;console.log("Game result: Bet "+this._lastGameResult.betAmount+", Win "+e),e>0?(this._lastGameResult.isMegaWin?(console.log("ðŸŽ‰ MEGA WIN! ðŸŽ‰"),this.playSFX("Common_Win1")):this._lastGameResult.isBigWin?(console.log("ðŸŽŠ BIG WIN! ðŸŽŠ"),this.playSFX("Common_Win1")):(console.log("âœ¨ WIN! âœ¨"),this.playSFX("Common_Win1")),this.setGameState(X.WIN)):(console.log("No win this time"),this.setGameState(X.READY))},l.showWinAnimation=function(){var e=this;if(console.log("Showing win animation..."),this.playSFX("Common_Win1"),this._winPrefab){var t=f(this._winPrefab);t.setParent(this.uiLayer),_(t).to(2,{scale:G.ONE}).call((function(){t.destroy(),e.setGameState(X.READY)})).start()}},l.showGameOver=function(){console.log("Game over...")},l.playSFX=function(e){this.audioManager&&this.audioManager.playSFXByName(e)},l.playBGM=function(e){this.audioManager&&this.audioManager.playBGM(e)},a(t,[{key:"gameState",get:function(){return this._gameState}},{key:"currentBalance",get:function(){return this._currentBalance},set:function(e){var t=this._currentBalance;this._currentBalance=e,this.settingsManager&&(this.settingsManager.currentBalance=e),t!==e&&M.instance.emit(E.BALANCE_CHANGED,{oldBalance:t,newBalance:e})}},{key:"currentBet",get:function(){return this._currentBet},set:function(e){if(S.instance.isValidBetAmount(e)){var t=this._currentBet;this._currentBet=e,this.settingsManager&&(this.settingsManager.currentBet=e),t!==e&&M.instance.emit(E.BET_CHANGED,{oldBet:t,newBet:e})}}},{key:"isAutoPlay",get:function(){return this._isAutoPlay},set:function(e){this._isAutoPlay=e}},{key:"gameSpeed",get:function(){return this._gameSpeed},set:function(e){this._gameSpeed=e,this.settingsManager&&(this.settingsManager.autoPlaySpeed=e)}}],[{key:"instance",get:function(){return t._instance},set:function(e){t._instance=e}}]),t}(d))._instance=null,P=t((I=Y).prototype,"gameCanvas",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(I.prototype,"uiLayer",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(I.prototype,"gameLayer",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(I.prototype,"settingsManager",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=t(I.prototype,"audioManager",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(I.prototype,"gameController",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=t(I.prototype,"ticketGameController",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=I))||k)),e("GameState",function(e){return e[e.LOADING=0]="LOADING",e[e.MENU=1]="MENU",e[e.READY=2]="READY",e[e.PLAYING=3]="PLAYING",e[e.SCRATCHING=4]="SCRATCHING",e[e.REVEALING=5]="REVEALING",e[e.WIN=6]="WIN",e[e.GAME_OVER=7]="GAME_OVER",e}({})));l._RF.pop()}}}));

System.register("chunks:///_virtual/GameSceneController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./SettingsManager.ts","./AudioManager.ts","./LocalGameController.ts","./GameManager.ts","./UIManager.ts"],(function(e){var n,a,o,t,i,r,l,s,g,c,u,d,f,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,a=e.inheritsLoose,o=e.initializerDefineProperty,t=e.assertThisInitialized},function(e){i=e.cclegacy,r=e._decorator,l=e.director,s=e.Component},function(e){g=e.GameConfig},function(e){c=e.SettingsManager},function(e){u=e.AudioManager},function(e){d=e.LocalGameController},function(e){f=e.GameManager},function(e){m=e.UIManager}],execute:function(){var M,h,G,p,C,S,b,y,z,w,I,v,B,A,L;i._RF.push({},"c0f9e4g3-6g7d-8e9f-0g1h-2i3j4k5l6m7n","GameSceneController",void 0);var U=r.ccclass,E=r.property;e("GameSceneController",(M=U("GameSceneController"),h=E(g),G=E(c),p=E(u),C=E(d),S=E(f),b=E(m),M((w=n((z=function(e){function n(){for(var n,a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return n=e.call.apply(e,[this].concat(i))||this,o(n,"gameConfig",w,t(n)),o(n,"settingsManager",I,t(n)),o(n,"audioManager",v,t(n)),o(n,"localGameController",B,t(n)),o(n,"gameManager",A,t(n)),o(n,"uiManager",L,t(n)),n._initialized=!1,n}a(n,e);var i=n.prototype;return i.onLoad=function(){console.log("=== Game Scene Loading ==="),console.log("GameSceneController.onLoad() called"),console.warn("ðŸŽ® GAMESCENECONTROLLER IS RUNNING!"),this.initializeManagers()},i.start=function(){console.log("=== Game Scene Started ==="),this.verifyInitialization(),this.startBackgroundMusic(),this.showGameUI()},i.initializeManagers=function(){console.log("Initializing game managers..."),g.instance?console.log("âœ“ GameConfig ready"):console.error("GameConfig not initialized!"),this.settingsManager?(this.settingsManager.loadSettings(),console.log("âœ“ SettingsManager initialized"),console.log("  - Balance: $"+this.settingsManager.currentBalance),console.log("  - Current Bet: $"+this.settingsManager.currentBet),console.log("  - BGM Volume: "+this.settingsManager.bgmVolume),console.log("  - SFX Volume: "+this.settingsManager.sfxVolume)):console.warn("âš  SettingsManager not found"),this.audioManager?console.log("âœ“ AudioManager initialized"):console.warn("âš  AudioManager not found"),this.localGameController?console.log("âœ“ LocalGameController initialized"):console.warn("âš  LocalGameController not found"),this.gameManager?console.log("âœ“ GameManager initialized"):console.warn("âš  GameManager not found"),this.uiManager?console.log("âœ“ UIManager initialized"):console.warn("âš  UIManager not found"),this._initialized=!0,console.log("=== All managers initialized ===")},i.verifyInitialization=function(){var e=[];g.instance||e.push("GameConfig not initialized"),this.settingsManager||e.push("SettingsManager not found"),this.audioManager||e.push("AudioManager not found"),this.localGameController||e.push("LocalGameController not found"),this.gameManager||e.push("GameManager not found"),this.uiManager||e.push("UIManager not found"),e.length>0?(console.error("=== Initialization Errors ==="),e.forEach((function(e){return console.error("  âœ— "+e)})),console.error("Game may not function correctly!")):console.log("=== All systems verified ===")},i.startBackgroundMusic=function(){var e=u.instance,n=c.instance;if(e&&n)if(n.bgmEnabled){var a=g.instance;e.playBGM(a.RESOURCE_PATHS.BGM_MAIN),console.log("ðŸŽµ Background music started from GameSceneController")}else console.log("Background music disabled in settings");else console.warn("âš ï¸ AudioManager or SettingsManager singleton not available in GameSceneController")},i.showGameUI=function(){this.uiManager&&(this.uiManager.showGameScreen(),this.uiManager.updateUI(),console.log("Game UI displayed"))},i.returnToStart=function(){console.log("Returning to start scene..."),this.settingsManager&&this.settingsManager.saveSettings(),this.audioManager&&this.audioManager.stopBGM(),l.loadScene("start",(function(e){e?console.error("Failed to load start scene:",e):console.log("Returned to start scene")}))},i.onDestroy=function(){console.log("Game scene destroyed"),this.settingsManager&&this.settingsManager.saveSettings()},n}(s)).prototype,"gameConfig",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=n(z.prototype,"settingsManager",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=n(z.prototype,"audioManager",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=n(z.prototype,"localGameController",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(z.prototype,"gameManager",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=n(z.prototype,"uiManager",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=z))||y));i._RF.pop()}}}));

System.register("chunks:///_virtual/LabelSkin.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(n){var i,t,e,o,l,s,r,a,h,u,c,k,S,b,f,p;return{setters:[function(n){i=n.applyDecoratedDescriptor,t=n.inheritsLoose,e=n.initializerDefineProperty,o=n.assertThisInitialized},function(n){l=n.cclegacy,s=n._decorator,r=n.Label,a=n.Color,h=n.LabelOutline,u=n.LabelShadow,c=n.Font,k=n.CCInteger,S=n.error,b=n.warn,f=n.tween,p=n.Component}],execute:function(){var d,g,y,m,w,C,z,L,v,x,A,F,I,M,E,R,T,V,_,D,N,P,O,j,B;l._RF.push({},"d2f07IzyyxCTozrAr/x4sG/","LabelSkin",void 0);var G=s.ccclass,H=s.property;s.menu,n("default",(d=G("LabelSkin"),g=H({type:r,tooltip:"The Label component to apply skins to. Auto-detected if not assigned."}),y=H({tooltip:"Enable color skin switching for the label text"}),m=H({type:[a],tooltip:"Array of colors for label text. Each index represents a different skin.",visible:function(){return this.enableColorSkins}}),w=H({type:h,tooltip:"Label outline component. Leave empty if no outline is used."}),C=H({type:[a],tooltip:"Array of colors for label outline. Must match the length of color skins.",visible:function(){return null!==this.outline}}),z=H({type:u,tooltip:"Label shadow component. Leave empty if no shadow is used."}),L=H({type:[a],tooltip:"Array of colors for label shadow. Must match the length of color skins.",visible:function(){return null!==this.shadow}}),v=H({tooltip:"Enable font switching for different skins"}),x=H({type:[c],tooltip:"Array of fonts. Each index represents a different skin.",visible:function(){return this.enableFontSkins}}),A=H({tooltip:"Enable font size switching for different skins"}),F=H({type:[k],tooltip:"Array of font sizes. Each index represents a different skin.",visible:function(){return this.enableSizeSkins}}),d((E=i((M=function(n){function i(){for(var i,t=arguments.length,l=new Array(t),s=0;s<t;s++)l[s]=arguments[s];return i=n.call.apply(n,[this].concat(l))||this,e(i,"label",E,o(i)),e(i,"enableColorSkins",R,o(i)),e(i,"colorSkins",T,o(i)),e(i,"outline",V,o(i)),e(i,"outlineColorSkins",_,o(i)),e(i,"shadow",D,o(i)),e(i,"shadowColorSkins",N,o(i)),e(i,"enableFontSkins",P,o(i)),e(i,"fontSkins",O,o(i)),e(i,"enableSizeSkins",j,o(i)),e(i,"sizeSkins",B,o(i)),i}t(i,n);var l=i.prototype;return l.onLoad=function(){this.label||(this.label=this.node.getComponent(r),this.label||S("[LabelSkin] No Label component found on this node. Please add a Label component or assign one manually.")),this.validateSkinArrays()},l.SetSkin=function(n){return this.isValidSkinIndex(n)?this.label?(this.enableColorSkins&&this.colorSkins.length>n&&(this.label.color=this.colorSkins[n]),this.outline&&this.outlineColorSkins.length>n&&(this.outline.color=this.outlineColorSkins[n]),this.shadow&&this.shadowColorSkins.length>n&&(this.shadow.color=this.shadowColorSkins[n]),this.enableFontSkins&&this.fontSkins.length>n&&(this.label.font=this.fontSkins[n]),this.enableSizeSkins&&this.sizeSkins.length>n&&(this.label.fontSize=this.sizeSkins[n]),!0):(S("[LabelSkin] Cannot apply skin: Label component is not assigned."),!1):(S("[LabelSkin] Invalid skin index: "+n+". Valid range is 0-"+(this.getSkinCount()-1)),!1)},l.applyRandomSkin=function(){var n=this.getSkinCount();if(0===n)return b("[LabelSkin] No skins available for random selection."),-1;var i=this.getRandomInt(0,n-1);return this.SetSkin(i),i},l.TweenToSkin=function(n,i){return void 0===i&&(i=.3),this.isValidSkinIndex(n)?this.label?(this.enableColorSkins&&this.colorSkins.length>n&&f(this.label).to(i,{color:this.colorSkins[n]}).start(),this.outline&&this.outlineColorSkins.length>n&&f(this.outline).to(i,{color:this.outlineColorSkins[n]}).start(),this.shadow&&this.shadowColorSkins.length>n&&f(this.shadow).to(i,{color:this.shadowColorSkins[n]}).start(),this.enableFontSkins&&this.fontSkins.length>n&&(this.label.font=this.fontSkins[n]),this.enableSizeSkins&&this.sizeSkins.length>n&&(this.label.fontSize=this.sizeSkins[n]),!0):(S("[LabelSkin] Cannot tween skin: Label component is not assigned."),!1):(S("[LabelSkin] Invalid skin index: "+n+". Valid range is 0-"+(this.getSkinCount()-1)),!1)},l.getSkinCount=function(){return this.colorSkins.length},l.validateSkinArrays=function(){var n=this.getSkinCount();0!==n?(this.outline&&this.outlineColorSkins.length!==n&&b("[LabelSkin] Outline color skins count ("+this.outlineColorSkins.length+") does not match color skins count ("+n+"). Some skins may not work correctly."),this.shadow&&this.shadowColorSkins.length!==n&&b("[LabelSkin] Shadow color skins count ("+this.shadowColorSkins.length+") does not match color skins count ("+n+"). Some skins may not work correctly."),this.enableFontSkins&&this.fontSkins.length!==n&&b("[LabelSkin] Font skins count ("+this.fontSkins.length+") does not match color skins count ("+n+"). Some skins may not work correctly."),this.enableSizeSkins&&this.sizeSkins.length!==n&&b("[LabelSkin] Size skins count ("+this.sizeSkins.length+") does not match color skins count ("+n+"). Some skins may not work correctly.")):b("[LabelSkin] No color skins defined. Component will not function properly.")},l.isValidSkinIndex=function(n){return n>=0&&n<this.getSkinCount()},l.getRandomInt=function(n,i){var t=Math.ceil(n),e=Math.floor(i);return Math.floor(Math.random()*(e-t+1))+t},i}(p)).prototype,"label",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=i(M.prototype,"enableColorSkins",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T=i(M.prototype,"colorSkins",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),V=i(M.prototype,"outline",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=i(M.prototype,"outlineColorSkins",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),D=i(M.prototype,"shadow",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=i(M.prototype,"shadowColorSkins",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),P=i(M.prototype,"enableFontSkins",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),O=i(M.prototype,"fontSkins",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),j=i(M.prototype,"enableSizeSkins",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),B=i(M.prototype,"sizeSkins",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=M))||I));l._RF.pop()}}}));

System.register("chunks:///_virtual/LineViewController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./RowView.ts","./EventManager.ts","./GameEvents.ts"],(function(e){var n,t,i,o,r,s,l,a,c,u;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,l=e.Component},function(e){a=e.RowView},function(e){c=e.EventManager},function(e){u=e.GameEvents}],execute:function(){var w,h,f,L,g;r._RF.push({},"27548xkRjZAaojSKPKIa9Fg","LineViewController",void 0);var p=s.ccclass,V=s.property;e("LineViewController",(w=p("LineViewController"),h=V([a]),w((g=n((L=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return n=e.call.apply(e,[this].concat(r))||this,i(n,"rowViews",g,o(n)),n.currentGameResult=null,n}t(n,e);var r=n.prototype;return r.onLoad=function(){this.resetAllLines(),c.instance&&(c.instance.on(u.GAME_RESULT_GENERATED,this.onGameResultGenerated,this),c.instance.on(u.SCRATCH_COMPLETE,this.onScratchComplete,this))},r.onDestroy=function(){c.instance&&c.instance.targetOff(this)},r.onGameResultGenerated=function(e){this.currentGameResult=e.result,this.resetAllLines()},r.onScratchComplete=function(){this.currentGameResult?this.showResultLines(this.currentGameResult):console.warn("[LineViewController] No game result available")},r.resetAllLines=function(){this.rowViews.forEach((function(e,n){e&&e.SetSkin(0)})),console.log("[LineViewController] All lines reset to normal")},r.showResultLines=function(e){if(!e.winningLines||0===e.winningLines.length)return console.log("[LineViewController] No winning lines - all lines show lose"),void this.rowViews.forEach((function(e){e&&e.SetSkin(2)}));var n=new Set(e.winningLines.map((function(e){return e.lineIndex})));this.rowViews.forEach((function(e,t){e&&(n.has(t)?(e.SetSkin(1),console.log("[LineViewController] Line "+t+" set to WIN")):(e.SetSkin(2),console.log("[LineViewController] Line "+t+" set to LOSE")))})),console.log("[LineViewController] Displayed "+e.winningLines.length+" winning lines, others show lose")},n}(l)).prototype,"rowViews",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),f=L))||f));r._RF.pop()}}}));

System.register("chunks:///_virtual/LocalGameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./EventManager.ts","./GameEvents.ts"],(function(n){var i,e,t,r,a,o,l,s,u;return{setters:[function(n){i=n.inheritsLoose,e=n.createForOfIteratorHelperLoose,t=n.createClass},function(n){r=n.cclegacy,a=n._decorator,o=n.Component},function(n){l=n.GameConfig},function(n){s=n.EventManager},function(n){u=n.GameEvents}],execute:function(){var c,p;r._RF.push({},"2289dKIhmZA4b3u4KCK0LF6","LocalGameController",void 0);var g=a.ccclass,m=n("PrizeType",function(n){return n.LABUBU_SMALL="LABUBU_SMALL",n.LABUBU_MEDIUM="LABUBU_MEDIUM",n.LABUBU_BIG="LABUBU_BIG",n.LABUBU_MEGA="LABUBU_MEGA",n.COIN_SMALL="COIN_SMALL",n.COIN_MEDIUM="COIN_MEDIUM",n.COIN_BIG="COIN_BIG",n.STAR="STAR",n.HEART="HEART",n.DIAMOND="DIAMOND",n.EMPTY="EMPTY",n}({}));n("LocalGameController",g("LocalGameController")(((p=function(n){function r(){return n.apply(this,arguments)||this}i(r,n);var a=r.prototype;return a.onLoad=function(){r._instance=this,console.log("LocalGameController initialized (Result Manager)")},a.generateLotteryTicket=function(n){for(var i=l.instance,e=[],t=[],r=0;r<9;r++)t[r]=Math.floor(9*Math.random())+1;for(var a=Math.floor(3*Math.random())+1,o=[],s=0;s<i.PAYLINES.length;s++)o.push(s);var u=[];if(0===i.PAYLINES.length)console.error("[LocalGameController] PAYLINES configuration is empty - cannot generate winning lines");else{var c=[{name:"x1",indices:o.filter((function(n){var e;return 1===(null==(e=i.PAYLINES[n])?void 0:e.multiplier)})),maxMultiplier:1},{name:"x7",indices:o.filter((function(n){var e,t=(null==(e=i.PAYLINES[n])?void 0:e.multiplier)||0;return 3===t||7===t})),maxMultiplier:7},{name:"x300",indices:o.filter((function(n){var e,t=(null==(e=i.PAYLINES[n])?void 0:e.multiplier)||0;return 30===t||300===t})),maxMultiplier:300},{name:"x3333",indices:o.filter((function(n){var e;return 3333===(null==(e=i.PAYLINES[n])?void 0:e.multiplier)})),maxMultiplier:3333}].filter((function(n){return n.indices.length>0})),p=c[Math.floor(Math.random()*c.length)];p||(p={name:"fallback",indices:[].concat(o),maxMultiplier:Math.max.apply(Math,o.map((function(n){var e;return(null==(e=i.PAYLINES[n])?void 0:e.multiplier)||0})))});var g=function(n){if(0!==n.length){var i=n[Math.floor(Math.random()*n.length)],e=o.indexOf(i);return-1!==e&&o.splice(e,1),i}},m=g(p.indices);void 0===m&&(m=g([].concat(o))),void 0!==m&&u.push(m);for(var L=p.maxMultiplier,f=Math.max(a,1),h=function(){var n=o.filter((function(n){var e=i.PAYLINES[n];return e&&e.multiplier<=L})),e=n.length>0?n:[].concat(o);if(0===e.length)return null;var t=e[Math.floor(Math.random()*e.length)],r=o.indexOf(t);return-1!==r&&o.splice(r,1),t};u.length<f&&o.length>0;){var M=h();if(null===M)break;var v=i.PAYLINES[M];v&&(v.multiplier<=L&&u.push(M))}}u.forEach((function(n){var e=i.PAYLINES[n];if(e){e.positions.forEach((function(n){t[n]=7}))}else console.warn("[LocalGameController] Skipping invalid payline index "+n+" (PAYLINES length: "+i.PAYLINES.length+")")}));for(var d=Object.keys(i.PRIZE_PROBABILITIES),I=0;I<9;I++){var A=this.selectRandomPrize(d),E=i.getPrizeMultiplier(A);e.push({type:A,multiplier:E,count:1,iconPath:i.getPrizeIconPath(A),displayNumber:t[I]})}var P=this.calculateWinnings(t,n);return{prizes:e,totalWin:P.totalWin,isWin:P.isWin,isBigWin:P.isBigWin,isMegaWin:P.isMegaWin,betAmount:n,timestamp:Date.now(),winningLines:P.winningLines,resultLines:t}},a.selectRandomPrize=function(n){for(var i,t=l.instance,r=0,a=[],o=e(n);!(i=o()).done;){var s=i.value,u=t.PRIZE_PROBABILITIES[s]||0;r+=u,a.push({type:s,weight:u})}for(var c=Math.random()*r,p=0,g=a;p<g.length;p++){var L=g[p],f=L.type;if((c-=L.weight)<=0)return f}return m.EMPTY},a.calculateWinnings=function(n,i){var e=l.instance,t=[],r=0,a=["Row 1","Row 2","Row 3","Column 1","Column 2","Column 3","Diagonal 1","Diagonal 2"];e.PAYLINES.forEach((function(e,o){var l=e.positions.map((function(i){return n[i]||0}));if(3===l.length&&l[0]===l[1]&&l[1]===l[2]&&l[0]>=1&&l[0]<=9){var s=l[0],u=i*e.multiplier;r+=u,t.push({lineIndex:o,positions:[].concat(e.positions),multiplier:e.multiplier,prizeType:m.LABUBU_MEDIUM,winAmount:u,lineName:a[o],displayNumbers:[].concat(l),matchingNumber:s}),console.log("Line "+(o+1)+" WIN: "+s+" x3 ("+a[o]+" - positions "+e.positions.join(",")+") = "+u+" ("+e.multiplier+"x multiplier)")}}));var o=r>0,s=r>=i*e.BIG_WIN_THRESHOLD,u=r>=i*e.MEGA_WIN_THRESHOLD;return console.log("[calculateWinnings] Processed all 8 lines: "+t.length+" winning lines found"),o&&console.log("Total win: "+r+" from "+t.length+" winning lines"),{totalWin:r,isWin:o,isBigWin:s,isMegaWin:u,winningLines:t,resultLines:n}},a.validateBet=function(n,i){return l.instance.isValidBetAmount(n)?n>i?{isValid:!1,error:"Insufficient balance"}:{isValid:!0}:{isValid:!1,error:"Invalid bet amount"}},a.playRound=function(n,i){var e=this.validateBet(n,i);if(!e.isValid)return{success:!1,error:e.error};var t=this.generateLotteryTicket(n);return console.log("[LocalGameController] Game result generated:",t),s.instance?(s.instance.emit(u.GAME_RESULT_GENERATED,{result:t,betAmount:n}),console.log("[LocalGameController] GAME_RESULT_GENERATED event emitted")):console.warn("[LocalGameController] EventManager not available"),{success:!0,result:t,betAmount:n}},a.generateDemoTicket=function(n,i){void 0===i&&(i=!1);var e=l.instance,t=[];if(!i)return this.generateLotteryTicket(n);for(var r=m.LABUBU_MEDIUM,a=e.getPrizeMultiplier(r),o=0;o<3;o++)t.push({type:r,multiplier:a,count:1,iconPath:e.getPrizeIconPath(r),displayNumber:7});for(var s=3;s<9;s++){var u=s%2==0?m.COIN_SMALL:m.STAR,c=s%8+1;7===c&&(c=8),t.push({type:u,multiplier:e.getPrizeMultiplier(u),count:1,iconPath:e.getPrizeIconPath(u),displayNumber:c})}var p=t.map((function(n){return n.displayNumber})),g=this.calculateWinnings(p,n);return{prizes:t,totalWin:g.totalWin,isWin:g.isWin,isBigWin:g.isBigWin,isMegaWin:g.isMegaWin,betAmount:n,timestamp:Date.now(),winningLines:g.winningLines,resultLines:g.resultLines}},a.generateDemoLineWin=function(n,i){void 0===i&&(i=0);var e=l.instance,t=[];(i<0||i>=e.PAYLINES.length)&&(console.warn("Invalid line index "+i+", using 0"),i=0);for(var r=e.PAYLINES[i],a=m.LABUBU_MEDIUM,o=0;o<9;o++){var s=o%2==0?m.COIN_SMALL:m.STAR,u=o%8+1;7===u&&(u=8),t.push({type:s,multiplier:e.getPrizeMultiplier(s),count:1,iconPath:e.getPrizeIconPath(s),displayNumber:u})}r.positions.forEach((function(n){t[n]={type:a,multiplier:e.getPrizeMultiplier(a),count:1,iconPath:e.getPrizeIconPath(a),displayNumber:7}}));var c=t.map((function(n){return n.displayNumber})),p=this.calculateWinnings(c,n);return console.log("Demo ticket generated with line "+(i+1)+" win (positions "+r.positions.join(",")+") - Expected win: "+n*r.multiplier),{prizes:t,totalWin:p.totalWin,isWin:p.isWin,isBigWin:p.isBigWin,isMegaWin:p.isMegaWin,betAmount:n,timestamp:Date.now(),winningLines:p.winningLines,resultLines:p.resultLines}},a.generateDemoMultiLineWin=function(n,i){void 0===i&&(i=[0,4]);for(var e=l.instance,t=[],r=0;r<9;r++)t.push({type:m.EMPTY,multiplier:0,count:1,iconPath:e.getPrizeIconPath(m.EMPTY),displayNumber:r%6+1});var a=[m.LABUBU_MEDIUM,m.COIN_SMALL,m.LABUBU_SMALL],o=[7,8,9];i.forEach((function(n,i){if(n>=0&&n<e.PAYLINES.length){var r=e.PAYLINES[n],l=a[i%a.length],s=o[i%o.length];r.positions.forEach((function(n){t[n]={type:l,multiplier:e.getPrizeMultiplier(l),count:1,iconPath:e.getPrizeIconPath(l),displayNumber:s}}))}}));var s=t.map((function(n){return n.displayNumber})),u=this.calculateWinnings(s,n);return console.log("Demo ticket generated with "+i.length+" line wins - Total expected win: "+u.totalWin),{prizes:t,totalWin:u.totalWin,isWin:u.isWin,isBigWin:u.isBigWin,isMegaWin:u.isMegaWin,betAmount:n,timestamp:Date.now(),winningLines:u.winningLines,resultLines:u.resultLines}},t(r,null,[{key:"instance",get:function(){return r._instance}}]),r}(o))._instance=null,c=p))||c);r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./debug-view-runtime-control.ts","./AudioManager.ts","./BalanceView.ts","./ButtonBuy.ts","./CostToPlayView.ts","./Dust.ts","./EventManager.ts","./GameConfig.ts","./GameEvents.ts","./GameManager.ts","./GameSceneController.ts","./LabelSkin.ts","./LineViewController.ts","./LocalGameController.ts","./ObjectPool.ts","./RowView.ts","./ScratchCardItemView.ts","./Scratchticket.ts","./SettingsManager.ts","./Singleton.ts","./SpriteSkin.ts","./StartSceneController.ts","./TicketGameController.ts","./UIManager.ts","./WinPopup.ts","./SceneSetup.ts","./ScratchCard.ts","./ScratchGameController.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/ObjectPool.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,n,r,o,a,s,u,l,c,p,b,f,h,j;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.createClass,r=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,s=e._decorator,u=e.Node,l=e.Prefab,c=e.error,p=e.instantiate,b=e.Tween,f=e.v3,h=e.NodePool,j=e.Component}],execute:function(){var v,m,y,d,P,_,g,O,T;a._RF.push({},"a1b2cPUVniQq83vEjRWeJCr","ObjectPool",void 0);var w=s.ccclass,z=s.property;e("ObjectPool",(v=w("ObjectPool"),m=z({type:u,visible:function(){return 0==this.usePrefab}}),y=z({type:l,visible:function(){return 1==this.usePrefab}}),v((_=t((P=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return t=e.call.apply(e,[this].concat(n))||this,r(t,"usePrefab",_,o(t)),r(t,"template",g,o(t)),r(t,"prefab",O,o(t)),r(t,"initCount",T,o(t)),t._pool=new h,t._usedObjects=[],t}i(t,e),t.create=function(e,i){void 0===i&&(i=10);var n=new t;return e instanceof u?(n.usePrefab=!1,n.template=e):(n.usePrefab=!0,n.prefab=e),n.initCount=i,n};var a=t.prototype;return a.initializePool=function(){if(this.objTemplate){this.template&&(this.template.active=!1);for(var e=0;e<this.initCount;e++){var t=p(this.objTemplate);this._pool.put(t)}}else c("objTemplate is not set, cannot initialize pool")},a.onDestroy=function(){this._pool.clear()},a.getObject=function(){if(!this.objTemplate)return c("objTemplate is not set"),null;var e=this._pool.get();return e||(e=p(this.objTemplate)),b.stopAllByTarget(e),e.parent=this.node,e.active=!0,e.position=f(0,0,0),this._usedObjects.push(e),e},a.returnObject=function(e){var t=this._usedObjects.indexOf(e);-1!==t&&this._usedObjects.splice(t,1),b.stopAllByTarget(e),e.active=!1,this._pool.put(e)},a.reset=function(){var e=this;[].concat(this._usedObjects).forEach((function(t){e.returnObject(t)})),this._usedObjects=[]},n(t,[{key:"objTemplate",get:function(){return this.usePrefab?this.prefab:this.template}},{key:"activeCount",get:function(){return this._usedObjects.length}}]),t}(j)).prototype,"usePrefab",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),g=t(P.prototype,"template",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(P.prototype,"prefab",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=t(P.prototype,"initCount",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),d=P))||d));a._RF.pop()}}}));

System.register("chunks:///_virtual/RowView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SpriteSkin.ts","./LabelSkin.ts"],(function(e){var i,n,t,r,o,a,l,u,c;return{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.Component},function(e){u=e.default},function(e){c=e.default}],execute:function(){var s,p,f,S,w,k,b;o._RF.push({},"d4aff4SQ99FIYSNq7yQAnwQ","RowView",void 0);var y=a.ccclass,h=a.property;e("RowView",(s=y("RowView"),p=h(u),f=h(c),s((k=i((w=function(e){function i(){for(var i,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return i=e.call.apply(e,[this].concat(o))||this,t(i,"arrowSkin",k,r(i)),t(i,"labelSkin",b,r(i)),i}return n(i,e),i.prototype.SetSkin=function(e){this.arrowSkin.setSkin(e),this.labelSkin.SetSkin(e)},i}(l)).prototype,"arrowSkin",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=i(w.prototype,"labelSkin",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=w))||S));o._RF.pop()}}}));

System.register("chunks:///_virtual/SceneSetup.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,r,a,i,s,c,l,d,u,p,C,v,S,w,m,f;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,i=e._decorator,s=e.Canvas,c=e.UITransform,l=e.Node,d=e.Sprite,u=e.Color,p=e.Widget,C=e.Vec3,v=e.Label,S=e.Button,w=e.Graphics,m=e.resources,f=e.Component}],execute:function(){var g,h,P,B,z;a._RF.push({},"69ddft/reBEBJ4Z9Yu+MzLb","SceneSetup",void 0);var y=i.ccclass,L=i.property;e("SceneSetup",(g=y("SceneSetup"),h=L({type:Boolean,tooltip:"Auto setup scene on load"}),g((z=t((B=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,o(t,"autoSetup",z,r(t)),t}n(t,e);var a=t.prototype;return a.onLoad=function(){this.autoSetup&&this.setupScene()},a.setupScene=function(){console.log("Setting up scratch card scene...");var e=this.node.getComponent(s);e||(e=this.node.addComponent(s));var t=this.node.getComponent(c);t&&t.setContentSize(750,1334),this.createBackground(),this.createGameController(),this.createUI(),console.log("Scene setup complete!")},a.createBackground=function(){var e=new l("Background");e.setParent(this.node);var t=e.addComponent(d),n=e.getComponent(c);n&&n.setContentSize(750,1334),t.color=new u(45,52,54,255);var o=e.addComponent(p);o.isAlignTop=!0,o.isAlignBottom=!0,o.isAlignLeft=!0,o.isAlignRight=!0,o.top=0,o.bottom=0,o.left=0,o.right=0,e.setSiblingIndex(0)},a.createGameController=function(){var e=new l("GameController");e.setParent(this.node);var t=new l("CardContainer");t.setParent(e),t.setPosition(new C(0,100,0)),t.addComponent(c).setContentSize(600,600)},a.createUI=function(){var e=new l("UI");e.setParent(this.node),this.createTopBar(e),this.createButtons(e),this.createWinDisplay(e)},a.createTopBar=function(e){var t=new l("TopBar");t.setParent(e),t.setPosition(new C(0,550,0));var n=new l("BalanceLabel");n.setParent(t),n.setPosition(new C(-200,0,0));var o=n.addComponent(v);o.string="Balance: 10,000",o.fontSize=32,o.color=new u(255,255,255,255);var r=n.getComponent(c);r&&r.setContentSize(300,50);var a=new l("TitleLabel");a.setParent(t),a.setPosition(new C(150,0,0));var i=a.addComponent(v);i.string="Scratch Card",i.fontSize=40,i.color=new u(255,215,0,255);var s=a.getComponent(c);s&&s.setContentSize(300,60)},a.createButtons=function(e){var t=new l("ButtonContainer");t.setParent(e),t.setPosition(new C(0,-450,0)),this.createButton("BuyButton","BUY (100)",new C(-150,0,0)).setParent(t);var n=this.createButton("RevealAllButton","REVEAL ALL",new C(150,0,0));n.setParent(t),n.active=!1},a.createButton=function(e,t,n){var o=new l(e);o.setPosition(n);o.addComponent(S);o.addComponent(d).color=new u(52,152,219,255);var r=o.getComponent(c);r&&r.setContentSize(250,80);var a=new l("Label");a.setParent(o);var i=a.addComponent(v);i.string=t,i.fontSize=28,i.color=new u(255,255,255,255);var s=a.getComponent(c);return s&&s.setContentSize(240,70),o},a.createWinDisplay=function(e){var t=new l("WinAmountLabel");t.setParent(e),t.setPosition(new C(0,-300,0));var n=t.addComponent(v);n.string="",n.fontSize=48,n.color=new u(255,215,0,255);var o=t.getComponent(c);o&&o.setContentSize(500,80)},a.createScratchCardPrefab=function(){var e=new l("ScratchCard"),t=new l("RewardLayer");t.setParent(e);t.addComponent(d);var n=t.getComponent(c);n&&n.setContentSize(500,400);var o=new l("ScratchLayer");o.setParent(e);var r=o.addComponent(w),a=o.getComponent(c);return a&&a.setContentSize(500,400),r.fillColor=new u(180,180,180,255),r.rect(-250,-200,500,400),r.fill(),e},a.createRewardGrid=function(e,t){var n=new l("RewardGrid");n.setParent(e);for(var o=150,r=0;r<3;r++)for(var a=0;a<3;a++){var i=new l("Cell_"+r+"_"+a);i.setParent(n);var s=160*a-160,p=160-160*r;i.setPosition(new C(s,p,0)),i.addComponent(d).color=new u(255,255,255,255);var S=i.getComponent(c);S&&S.setContentSize(o,o);var w=new l("Symbol");w.setParent(i);var m=w.addComponent(v);m.string=t[r][a],m.fontSize=60,m.color=new u(0,0,0,255);var f=w.getComponent(c);f&&f.setContentSize(o,o)}},a.loadAudioClips=function(){m.load("audio/Scratch",(function(e,t){e?console.error("Failed to load scratch sound:",e):console.log("Scratch sound loaded")})),m.load("audio/Show3",(function(e,t){e?console.error("Failed to load reveal sound:",e):console.log("Reveal sound loaded")})),m.load("audio/Common_Win1",(function(e,t){e?console.error("Failed to load win sound:",e):console.log("Win sound loaded")}))},t}(f)).prototype,"autoSetup",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),P=B))||P));a._RF.pop()}}}));

System.register("chunks:///_virtual/ScratchCard.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,a,r,s,c,h,n,o,u,l,d,p,_,f,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,a=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){s=t.cclegacy,c=t._decorator,h=t.Node,n=t.Graphics,o=t.AudioClip,u=t.AudioSource,l=t.UITransform,d=t.Color,p=t.Vec3,_=t.Vec2,f=t.Sprite,v=t.Component}],execute:function(){var y,S,g,b,T,m,L,C,P,w,z,E,x,k,H,M,D,R,G,U,A;s._RF.push({},"870c8HGUWxK/48ZXn/0IkJZ","ScratchCard",void 0);var O=c.ccclass,W=c.property;t("ScratchCard",(y=O("ScratchCard"),S=W(h),g=W(h),b=W(n),T=W(o),m=W(o),L=W({type:Number,tooltip:"Brush size for scratching"}),C=W({type:Number,tooltip:"Percentage to auto-reveal (0-100)"}),P=W({type:Boolean,tooltip:"Enable touch interaction"}),w=W({type:Boolean,tooltip:"Play sound effects"}),y((x=e((E=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return e=t.call.apply(t,[this].concat(s))||this,a(e,"scratchLayer",x,r(e)),a(e,"rewardLayer",k,r(e)),a(e,"maskGraphics",H,r(e)),a(e,"scratchSound",M,r(e)),a(e,"revealSound",D,r(e)),a(e,"brushSize",R,r(e)),a(e,"revealThreshold",G,r(e)),a(e,"enableTouch",U,r(e)),a(e,"enableSound",A,r(e)),e._isScratching=!1,e._scratchedPixels=0,e._totalPixels=0,e._scratchedPercentage=0,e._isRevealed=!1,e._audioSource=null,e._lastScratchPos=new _,e._scratchData=null,e._canvasWidth=0,e._canvasHeight=0,e}i(e,t);var s=e.prototype;return s.onLoad=function(){this.initializeComponents(),this.setupEventListeners(),this.initializeMask()},s.initializeComponents=function(){var t;this._audioSource=this.node.getComponent(u),!this._audioSource&&this.enableSound&&(this._audioSource=this.node.addComponent(u));var e=null==(t=this.scratchLayer)?void 0:t.getComponent(l);e&&(this._canvasWidth=e.width,this._canvasHeight=e.height),this._totalPixels=Math.floor(this._canvasWidth*this._canvasHeight),this._scratchData=new Uint8ClampedArray(this._totalPixels),this._scratchData.fill(1)},s.setupEventListeners=function(){this.enableTouch&&this.scratchLayer&&(this.scratchLayer.on(h.EventType.TOUCH_START,this.onTouchStart,this),this.scratchLayer.on(h.EventType.TOUCH_MOVE,this.onTouchMove,this),this.scratchLayer.on(h.EventType.TOUCH_END,this.onTouchEnd,this),this.scratchLayer.on(h.EventType.TOUCH_CANCEL,this.onTouchEnd,this))},s.initializeMask=function(){this.maskGraphics?(this.maskGraphics.clear(),this.maskGraphics.fillColor=new d(180,180,180,255),this.maskGraphics.rect(-this._canvasWidth/2,-this._canvasHeight/2,this._canvasWidth,this._canvasHeight),this.maskGraphics.fill()):console.warn("MaskGraphics not assigned")},s.onTouchStart=function(t){if(!this._isRevealed){this._isScratching=!0;var e=this.getTouchPosition(t);this._lastScratchPos.set(e),this.scratch(e),this.playScratchSound()}},s.onTouchMove=function(t){if(this._isScratching&&!this._isRevealed){var e=this.getTouchPosition(t);this.scratchLine(this._lastScratchPos,e),this._lastScratchPos.set(e),this.updateScratchProgress()}},s.onTouchEnd=function(t){this._isScratching=!1,this.stopScratchSound()},s.getTouchPosition=function(t){var e=t.getUILocation(),i=this.scratchLayer.getComponent(l).convertToNodeSpaceAR(new p(e.x,e.y,0));return new _(i.x,i.y)},s.scratch=function(t){this.maskGraphics&&(this.maskGraphics.circle(t.x,t.y,this.brushSize),this.maskGraphics.clear(),this.updateScratchData(t))},s.scratchLine=function(t,e){if(this.maskGraphics)for(var i=_.distance(t,e),a=Math.max(1,Math.floor(i/(this.brushSize/2))),r=0;r<=a;r++){var s=r/a,c=t.x+(e.x-t.x)*s,h=t.y+(e.y-t.y)*s,n=new _(c,h);this.scratch(n)}},s.updateScratchData=function(t){for(var e=Math.floor(t.x+this._canvasWidth/2),i=Math.floor(t.y+this._canvasHeight/2),a=this.brushSize,r=-a;r<=a;r++)for(var s=-a;s<=a;s++)if(s*s+r*r<=a*a){var c=e+s,h=i+r;if(c>=0&&c<this._canvasWidth&&h>=0&&h<this._canvasHeight){var n=Math.floor(h*this._canvasWidth+c);n>=0&&n<this._scratchData.length&&1===this._scratchData[n]&&(this._scratchData[n]=0,this._scratchedPixels++)}}},s.updateScratchProgress=function(){this._scratchedPercentage=this._scratchedPixels/this._totalPixels*100,this._scratchedPercentage>=this.revealThreshold&&!this._isRevealed&&this.revealAll()},s.revealAll=function(){this._isRevealed||(this._isRevealed=!0,this.scratchLayer&&(this.scratchLayer.active=!1),this.rewardLayer&&(this.rewardLayer.active=!0),this.enableSound&&this.revealSound&&this._audioSource&&this._audioSource.playOneShot(this.revealSound),this.node.emit("scratch-complete",this._scratchedPercentage))},s.reset=function(){this._isRevealed=!1,this._isScratching=!1,this._scratchedPixels=0,this._scratchedPercentage=0,this._scratchData.fill(1),this.scratchLayer&&(this.scratchLayer.active=!0),this.rewardLayer&&(this.rewardLayer.active=!1),this.initializeMask()},s.setReward=function(t){if(this.rewardLayer){var e=this.rewardLayer.getComponent(f);e&&(e.spriteFrame=t)}},s.playScratchSound=function(){this.enableSound&&this.scratchSound&&this._audioSource&&(this._audioSource.clip=this.scratchSound,this._audioSource.loop=!0,this._audioSource.play())},s.stopScratchSound=function(){this._audioSource&&this._audioSource.stop()},s.getScratchProgress=function(){return this._scratchedPercentage},s.isRevealed=function(){return this._isRevealed},s.onDestroy=function(){this.scratchLayer&&(this.scratchLayer.off(h.EventType.TOUCH_START,this.onTouchStart,this),this.scratchLayer.off(h.EventType.TOUCH_MOVE,this.onTouchMove,this),this.scratchLayer.off(h.EventType.TOUCH_END,this.onTouchEnd,this),this.scratchLayer.off(h.EventType.TOUCH_CANCEL,this.onTouchEnd,this))},e}(v)).prototype,"scratchLayer",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=e(E.prototype,"rewardLayer",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=e(E.prototype,"maskGraphics",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(E.prototype,"scratchSound",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(E.prototype,"revealSound",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(E.prototype,"brushSize",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),G=e(E.prototype,"revealThreshold",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 70}}),U=e(E.prototype,"enableTouch",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),A=e(E.prototype,"enableSound",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),z=E))||z));s._RF.pop()}}}));

System.register("chunks:///_virtual/ScratchCardItemView.ts",["./rollupPluginModLoBabelHelpers.js","cc","./LabelSkin.ts"],(function(e){var i,t,n,r,a,l,u,o,s,b;return{setters:[function(e){i=e.applyDecoratedDescriptor,t=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,l=e._decorator,u=e.Node,o=e.Label,s=e.Component},function(e){b=e.default}],execute:function(){var c,h,m,f,S,p,g,L,k,d,T,w,x;a._RF.push({},"813faWsdx9JAokekLOpRrXY","ScratchCardItemView",void 0);var v=l.ccclass,y=l.property;e("ScratchCardItemView",(c=v("ScratchCardItemView"),h=y(u),m=y(o),f=y(o),S=y(b),p=y(b),c((k=i((L=function(e){function i(){for(var i,t=arguments.length,a=new Array(t),l=0;l<t;l++)a[l]=arguments[l];return i=e.call.apply(e,[this].concat(a))||this,n(i,"highlightWinNode",k,r(i)),n(i,"numberLabel",d,r(i)),n(i,"numTextLabel",T,r(i)),n(i,"numberLabelSkin",w,r(i)),n(i,"numTextLabelSkin",x,r(i)),i.numText=["ONE","TWO","THR","FOR","FIV","SIX","POP","EIG","NIN"],i}t(i,e);var a=i.prototype;return a.setNum=function(e,i){if(void 0===i&&(i=!1),e<1||e>9)console.warn("[ItemPrizeView] Invalid num: "+e+". Valid range is 1-9");else{var t=e-1;this.numberLabel&&(this.numberLabel.string=e.toString()),this.numTextLabel&&(this.numTextLabel.string=this.numText[t]),i&&this.setDefaultSkin()}},a.setDefaultSkin=function(){this.highlightWinNode&&(this.highlightWinNode.active=!1),this.numberLabelSkin&&this.numberLabelSkin.SetSkin(0),this.numTextLabelSkin&&this.numTextLabelSkin.SetSkin(0)},a.setWin=function(e){void 0===e&&(e=.3),this.highlightWinNode&&(this.highlightWinNode.active=!0),this.numberLabelSkin&&this.numberLabelSkin.TweenToSkin(1,e),this.numTextLabelSkin&&this.numTextLabelSkin.TweenToSkin(1,e)},a.resetToDefault=function(){this.setDefaultSkin()},i}(s)).prototype,"highlightWinNode",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(L.prototype,"numberLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=i(L.prototype,"numTextLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=i(L.prototype,"numberLabelSkin",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=i(L.prototype,"numTextLabelSkin",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=L))||g));a._RF.pop()}}}));

System.register("chunks:///_virtual/ScratchGameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ScratchCard.ts"],(function(t){var e,n,r,a,i,o,l,u,c,s,h,d,b,p,f,m;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,r=t.initializerDefineProperty,a=t.assertThisInitialized},function(t){i=t.cclegacy,o=t._decorator,l=t.Prefab,u=t.Node,c=t.Label,s=t.Button,h=t.AudioClip,d=t.AudioSource,b=t.instantiate,p=t.Vec3,f=t.Component},function(t){m=t.ScratchCard}],execute:function(){var y,C,B,g,_,v,S,w,A,L,P,I,z,G,O,R,U,M,D,E,F,N,W,x,T;i._RF.push({},"6ed3cPxatFOwZmeVqswkjsX","ScratchGameController",void 0);var K=o.ccclass,j=o.property;t("ScratchGameController",(y=K("ScratchGameController"),C=j(l),B=j(u),g=j(c),_=j(c),v=j(s),S=j(s),w=j(h),A=j(h),L=j({type:Number,tooltip:"Cost per card"}),P=j({type:[String],tooltip:"Possible reward symbols"}),I=j({type:[Number],tooltip:"Multipliers for each payline"}),y((O=e((G=function(t){function e(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,r(e,"scratchCardPrefab",O,a(e)),r(e,"cardContainer",R,a(e)),r(e,"balanceLabel",U,a(e)),r(e,"winAmountLabel",M,a(e)),r(e,"buyButton",D,a(e)),r(e,"revealAllButton",E,a(e)),r(e,"winSound",F,a(e)),r(e,"buySound",N,a(e)),r(e,"cardCost",W,a(e)),r(e,"rewardSymbols",x,a(e)),r(e,"paylineMultipliers",T,a(e)),e._currentBalance=1e4,e._currentCard=null,e._audioSource=null,e._gameGrid=[],e._betAmount=100,e}n(e,t);var i=e.prototype;return i.onLoad=function(){this.initializeGame(),this.setupButtons(),this.updateUI()},i.initializeGame=function(){this._audioSource=this.node.getComponent(d),this._audioSource||(this._audioSource=this.node.addComponent(d));var t=this.loadBalance();t>0&&(this._currentBalance=t)},i.setupButtons=function(){this.buyButton&&this.buyButton.node.on(s.EventType.CLICK,this.onBuyCard,this),this.revealAllButton&&(this.revealAllButton.node.on(s.EventType.CLICK,this.onRevealAll,this),this.revealAllButton.node.active=!1)},i.updateUI=function(){this.balanceLabel&&(this.balanceLabel.string="Balance: "+this.formatCurrency(this._currentBalance)),this.winAmountLabel&&(this.winAmountLabel.string=""),this.buyButton&&(this.buyButton.interactable=this._currentBalance>=this.cardCost)},i.onBuyCard=function(){this._currentBalance<this.cardCost?console.warn("Insufficient balance"):(this._currentBalance-=this.cardCost,this.saveBalance(this._currentBalance),this.playSound(this.buySound),this.createScratchCard(),this.updateUI(),this.revealAllButton&&(this.revealAllButton.node.active=!0),this.buyButton&&(this.buyButton.interactable=!1))},i.createScratchCard=function(){(this._currentCard&&this._currentCard.destroy(),this.scratchCardPrefab&&this.cardContainer)?(this._currentCard=b(this.scratchCardPrefab),this._currentCard.setParent(this.cardContainer),this._currentCard.setPosition(p.ZERO),this.generateRewards(),this._currentCard.getComponent(m)&&this._currentCard.on("scratch-complete",this.onCardComplete,this)):console.error("Scratch card prefab or container not assigned")},i.generateRewards=function(){this._gameGrid=[];for(var t=0;t<3;t++){this._gameGrid[t]=[];for(var e=0;e<3;e++){var n=Math.floor(Math.random()*this.rewardSymbols.length);this._gameGrid[t][e]=this.rewardSymbols[n]}}},i.forceWinningCombination=function(){this._gameGrid[0][0]="POP",this._gameGrid[0][1]="POP",this._gameGrid[0][2]="POP"},i.onRevealAll=function(){if(this._currentCard){var t=this._currentCard.getComponent(m);t&&t.revealAll()}},i.onCardComplete=function(t){var e=this;console.log("Card revealed: "+t.toFixed(2)+"%");var n=this.calculateWinnings();n>0?(this._currentBalance+=n,this.saveBalance(this._currentBalance),this.winAmountLabel&&(this.winAmountLabel.string="WIN: "+this.formatCurrency(n)),this.playSound(this.winSound)):this.winAmountLabel&&(this.winAmountLabel.string="No Win"),this.updateUI(),this.revealAllButton&&(this.revealAllButton.node.active=!1),this.scheduleOnce((function(){e.buyButton&&(e.buyButton.interactable=e._currentBalance>=e.cardCost)}),2)},i.calculateWinnings=function(){var t=this,e=0;return[[[0,0],[0,1],[0,2]],[[1,0],[1,1],[1,2]],[[2,0],[2,1],[2,2]],[[0,0],[1,0],[2,0]],[[0,1],[1,1],[2,1]],[[0,2],[1,2],[2,2]],[[0,0],[1,1],[2,2]],[[0,2],[1,1],[2,0]]].forEach((function(n,r){var a=n.map((function(e){var n=e[0],r=e[1];return t._gameGrid[n][r]}));if(a[0]===a[1]&&a[1]===a[2]){var i=t.paylineMultipliers[r]||1,o=t._betAmount*i;e+=o,console.log("Payline "+(r+1)+" WIN: "+a[0]+" x3 = "+o)}})),e},i.formatCurrency=function(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})},i.playSound=function(t){t&&this._audioSource&&this._audioSource.playOneShot(t)},i.saveBalance=function(t){"undefined"!=typeof localStorage&&localStorage.setItem("scratchCardBalance",t.toString())},i.loadBalance=function(){if("undefined"!=typeof localStorage){var t=localStorage.getItem("scratchCardBalance");return t?parseInt(t,10):0}return 0},i.setBetAmount=function(t){this._betAmount=t,this.cardCost=t,this.updateUI()},i.addBalance=function(t){this._currentBalance+=t,this.saveBalance(this._currentBalance),this.updateUI()},i.getBalance=function(){return this._currentBalance},i.resetGame=function(){this._currentBalance=1e4,this.saveBalance(this._currentBalance),this._currentCard&&(this._currentCard.destroy(),this._currentCard=null),this.updateUI()},i.onDestroy=function(){this.buyButton&&this.buyButton.node.off(s.EventType.CLICK,this.onBuyCard,this),this.revealAllButton&&this.revealAllButton.node.off(s.EventType.CLICK,this.onRevealAll,this)},e}(f)).prototype,"scratchCardPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(G.prototype,"cardContainer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=e(G.prototype,"balanceLabel",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=e(G.prototype,"winAmountLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(G.prototype,"buyButton",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(G.prototype,"revealAllButton",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(G.prototype,"winSound",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=e(G.prototype,"buySound",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=e(G.prototype,"cardCost",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),x=e(G.prototype,"rewardSymbols",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return["POP","1","2","3","4","5","6","7","8","9"]}}),T=e(G.prototype,"paylineMultipliers",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[7,300,3333,50,100,200,500,1e3]}}),z=G))||z));i._RF.pop()}}}));

System.register("chunks:///_virtual/Scratchticket.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Dust.ts","./ObjectPool.ts","./EventManager.ts","./GameEvents.ts"],(function(t){var e,i,s,r,o,a,n,c,h,l,u,p,d,m,f,g,S,b,v,_,y,k,P,T,w,D;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,s=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,n=t.Prefab,c=t.Node,h=t.Graphics,l=t.Sprite,u=t.UITransform,p=t.Mask,d=t.input,m=t.Input,f=t.Vec2,g=t.Vec3,S=t.Color,b=t.randomRange,v=t.instantiate,_=t.Rect,y=t.SpriteFrame,k=t.Component},function(t){P=t.Dust},function(t){T=t.ObjectPool},function(t){w=t.EventManager},function(t){D=t.GameEvents}],execute:function(){var z,C,G,E,x,M,R,A,L,N,F,I,H,O,U,W,B,j,V,Y,X,Q,q,J,K,Z,$,tt,et,it,st,rt,ot,at,nt,ct,ht,lt,ut,pt,dt,mt,ft;o._RF.push({},"4d412f9vsxKzLhcwNjlzwWm","Scratchticket",void 0);var gt=a.ccclass,St=a.property;t("Scratchticket",(z=gt("Scratchticket"),C=St(n),G=St({type:c,tooltip:"Container for dust effects (optional)"}),E=St({type:Number,tooltip:"Brush size for scratching"}),x=St({type:Boolean,tooltip:"Enable debug logs"}),M=St({type:Boolean,tooltip:"Invert mask for scratch reveal behavior (true = scratched areas become transparent)"}),R=St({type:h,tooltip:"Graphics component for scratch mask (REQUIRED for disappearing effect)"}),A=St({type:l,tooltip:"Scratch layer sprite (REQUIRED for mask setup)"}),L=St({type:c,tooltip:"Reward layer to reveal underneath (optional)"}),N=St({type:Number,tooltip:"Minimum distance mouse must move before adding scratch point"}),F=St({type:Number,tooltip:"Dust particle size in pixels"}),I=St({type:Number,tooltip:"Minimum milliseconds between dust spawns (higher = slower)"}),H=St({type:Number,tooltip:"Maximum active dust particles"}),O=St({type:Number,tooltip:"DEPRECATED: No longer used since fallback recycle was removed"}),U=St({type:Number,tooltip:"Initial pool size for dust particles"}),W=St({type:Number,tooltip:"Minimum number of dust particles to spawn per click"}),B=St({type:Number,tooltip:"Maximum number of dust particles to spawn per click"}),j=St({type:Number,tooltip:"Percentage scratched to auto-reveal rewards (0-100)"}),V=St({type:Number,tooltip:"Percentage scratched per ticket item to emit threshold event (0-100)"}),Y=St({type:Number,tooltip:"Horizontal spread distance between multiple dust particles"}),X=St({type:Number,tooltip:"Vertical variation range for dust spawn positions (Â±)"}),z((J=e((q=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,s(e,"dustPrefab",J,r(e)),s(e,"dustContainer",K,r(e)),s(e,"brushSize",Z,r(e)),s(e,"enableDebug",$,r(e)),s(e,"invertMask",tt,r(e)),s(e,"maskGraphics",et,r(e)),s(e,"scratchLayerSprite",it,r(e)),s(e,"rewardLayer",st,r(e)),s(e,"minMoveDistance",rt,r(e)),s(e,"dustPixelSize",ot,r(e)),s(e,"dustSpawnInterval",at,r(e)),s(e,"maxActiveDust",nt,r(e)),s(e,"dustLifetime",ct,r(e)),s(e,"poolInitSize",ht,r(e)),s(e,"minDustPerSpawn",lt,r(e)),s(e,"maxDustPerSpawn",ut,r(e)),s(e,"autoRevealThreshold",pt,r(e)),s(e,"itemRevealThreshold",dt,r(e)),s(e,"dustSpreadX",mt,r(e)),s(e,"dustSpreadY",ft,r(e)),e._dustPool=null,e._lastDustSpawnTime=0,e._totalScratchDistance=0,e._minScratchDistance=50,e._currentPath=[],e._needsGraphicsFlush=!1,e._isTouching=!1,e._lastTouchPos=null,e._canvasWidth=0,e._canvasHeight=0,e._autoRevealTriggered=!1,e._scratchCompleteEmitted=!1,e._scratchGrid=new Map,e._gridSize=11,e._graphicsTargets=[],e._itemRows=3,e._itemCols=3,e._itemScratchGrids=[],e._isEnabled=!1,e}i(e,t);var o=e.prototype;return o.onLoad=function(){this.setupUITransform()},o.start=function(){this.setupDustContainer(),this.initializeScratchMask(),this.setupScratchLayerMask();try{this.setupObjectPool()}catch(t){console.error("[Scratchticket] Failed to setup object pool:",t)}this.registerTouchEvents(),this.enableDebug&&console.log("[Scratchticket] Component initialized")},o.onDestroy=function(){this.unregisterTouchEvents(),this.clearAllDust(),this.unscheduleAllCallbacks()},o.setupUITransform=function(){var t=this.node.getComponent(u);t||(t=this.node.addComponent(u)).setContentSize(640,960),this._canvasWidth=t.width,this._canvasHeight=t.height},o.initializeScratchMask=function(){if(this.maskGraphics){this.maskGraphics.clear(),this._scratchGrid.clear(),this._graphicsTargets=[this.maskGraphics],this._itemScratchGrids=[];for(var t=0;t<this._itemRows*this._itemCols;t++)this._itemScratchGrids.push(new Map);console.log("[Scratchticket] Mask initialized - scratch layer ready")}else console.error("[Scratchticket] maskGraphics is required!")},o.setupScratchLayerMask=function(){if(this.scratchLayerSprite&&this.maskGraphics){var t=this.scratchLayerSprite.node,e=t.getComponent(p);e||(e=t.addComponent(p)),e.type=p.Type.GRAPHICS_STENCIL,e.inverted=this.invertMask,this.enableDebug&&console.log("[Scratchticket] Scratch layer mask setup complete")}else this.enableDebug&&console.warn("[Scratchticket] Cannot setup mask - missing components")},o.registerTouchEvents=function(){d.on(m.EventType.TOUCH_START,this.onTouchStart,this),d.on(m.EventType.TOUCH_MOVE,this.onTouchMove,this),d.on(m.EventType.TOUCH_END,this.onTouchEnd,this),d.on(m.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},o.unregisterTouchEvents=function(){d.off(m.EventType.TOUCH_START,this.onTouchStart,this),d.off(m.EventType.TOUCH_MOVE,this.onTouchMove,this),d.off(m.EventType.TOUCH_END,this.onTouchEnd,this),d.off(m.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},o.onTouchStart=function(t){if(this._isEnabled){var e=this.getTouchLocalPosition(t);if(e&&this.isPositionWithinBounds(e)){this._isTouching=!0,this._lastTouchPos=new f(e.x,e.y),this._totalScratchDistance=0,this._currentPath.length=0;var i=new g(e.x,e.y,0);this.isPositionNewlyScratchable(i)&&(this.spawnDustAtPosition(i),this._lastDustSpawnTime=Date.now()),this.scratchAt(new f(e.x,e.y)),this.flushGraphicsOperations(),this.enableDebug&&console.log("[Scratchticket] Touch START at:",e)}}},o.onTouchMove=function(t){if(this._isTouching&&this._lastTouchPos){var e=this.getTouchLocalPosition(t);if(e&&this.isPositionWithinBounds(e)){var i=new f(e.x,e.y),s=f.distance(this._lastTouchPos,i);if(this._totalScratchDistance+=s,s>=this.minMoveDistance){var r=Date.now();r-this._lastDustSpawnTime>=this.dustSpawnInterval&&(this.spawnDustAlongPath(this._lastTouchPos,i),this._lastDustSpawnTime=r),this.scratchLine(this._lastTouchPos,i),this._lastTouchPos.set(i),this._needsGraphicsFlush=!0,this.flushGraphicsOperations()}}}},o.onTouchEnd=function(t){this._isTouching=!1,this._lastTouchPos=null,this._currentPath.length>0&&(this._needsGraphicsFlush=!0,this.flushGraphicsOperations()),this.updateScratchProgress(),this.enableDebug&&console.log("[Scratchticket] Touch END")},o.getTouchLocalPosition=function(t){var e=this.node.getComponent(u);if(!e)return console.error("[Scratchticket] UITransform not found!"),null;var i=t.getUILocation();return e.convertToNodeSpaceAR(new g(i.x,i.y,0))},o.isPositionWithinBounds=function(t){var e=this._canvasWidth/2,i=this._canvasHeight/2;return t.x>=-e&&t.x<=e&&t.y>=-i&&t.y<=i},o.scratchAt=function(t){if(this.maskGraphics){this._currentPath.push(t.clone());for(var e=this.brushSize/2,i=Math.ceil(e/this._gridSize),s=Math.floor(t.x/this._gridSize),r=Math.floor(t.y/this._gridSize),o=-i;o<=i;o++)for(var a=-i;a<=i;a++){var n=s+o,c=r+a,h=n+","+c;this._scratchGrid.set(h,!0),this.markItemGridCell(n,c)}this._needsGraphicsFlush=!0}},o.markItemGridCell=function(t,e){var i=this._canvasWidth/this._itemCols,s=this._canvasHeight/this._itemRows,r=t*this._gridSize,o=e*this._gridSize,a=Math.floor((r+this._canvasWidth/2)/i),n=Math.floor((-o+this._canvasHeight/2)/s);if(a>=0&&a<this._itemCols&&n>=0&&n<this._itemRows){var c=n*this._itemCols+a,h=t+","+e;this._itemScratchGrids[c].set(h,!0)}},o.scratchLine=function(t,e){if(this.maskGraphics){for(var i=f.distance(t,e),s=Math.max(1,Math.floor(i/(.3*this.brushSize))),r=1;r<=s;r++){var o=r/s,a=t.x+(e.x-t.x)*o,n=t.y+(e.y-t.y)*o,c=new f(a,n);this._currentPath.push(c.clone());for(var h=this.brushSize/2,l=Math.ceil(h/this._gridSize),u=Math.floor(c.x/this._gridSize),p=Math.floor(c.y/this._gridSize),d=0,m=-l;m<=l;m++)for(var g=-l;g<=l;g++){var S=u+m,b=p+g,v=S+","+b;this._scratchGrid.set(v,!0),d++,this.markItemGridCell(S,b)}console.log("[DEBUG] scratchAt marked cells:",d,"total grid size:",this._scratchGrid.size)}this._needsGraphicsFlush=!0}},o.flushGraphicsOperations=function(){if(this._needsGraphicsFlush&&this.maskGraphics&&0!==this._currentPath.length){if(console.log("[DEBUG] flushGraphics executing:",{pathLength:this._currentPath.length,firstPoint:this._currentPath[0]}),this.maskGraphics)if(1===this._currentPath.length){var t=this._currentPath[0];console.log("[DEBUG] Drawing circle at:",t,"radius:",this.brushSize/2),this.maskGraphics.circle(t.x,t.y,this.brushSize/2),this.maskGraphics.fillColor=S.WHITE,this.maskGraphics.fill()}else{console.log("[DEBUG] Drawing line with",this._currentPath.length,"points"),this.maskGraphics.lineWidth=this.brushSize,this.maskGraphics.strokeColor=S.WHITE,this.maskGraphics.lineCap=1,this.maskGraphics.lineJoin=1;var e=this._currentPath[0];this.maskGraphics.moveTo(e.x,e.y);for(var i=1;i<this._currentPath.length;i++){var s=this._currentPath[i];this.maskGraphics.lineTo(s.x,s.y)}this.maskGraphics.stroke()}this._currentPath.length=0,this._needsGraphicsFlush=!1}else console.log("[DEBUG] flushGraphics skipped:",{needsFlush:this._needsGraphicsFlush,hasMaskGraphics:!!this.maskGraphics,pathLength:this._currentPath.length})},o.updateScratchProgress=function(){for(var t,e,i,s,r,o,a,n,c,h=this._canvasWidth*this._canvasHeight/(this._gridSize*this._gridSize)/(this._itemRows*this._itemCols),l=[],u=0;u<this._itemScratchGrids.length;u++){var p=this._itemScratchGrids[u].size,d=Math.min(100,p/h*100);l.push(d)}var m=l.every((function(t){return t>=28}));console.log("[DEBUG] Per-item progress:",{item0:null==(t=l[0])?void 0:t.toFixed(1),item1:null==(e=l[1])?void 0:e.toFixed(1),item2:null==(i=l[2])?void 0:i.toFixed(1),item3:null==(s=l[3])?void 0:s.toFixed(1),item4:null==(r=l[4])?void 0:r.toFixed(1),item5:null==(o=l[5])?void 0:o.toFixed(1),item6:null==(a=l[6])?void 0:a.toFixed(1),item7:null==(n=l[7])?void 0:n.toFixed(1),item8:null==(c=l[8])?void 0:c.toFixed(1),allItemsAbove28:m}),!this._autoRevealTriggered&&m&&(console.log("[Scratchticket] All items above 28% - triggering auto reveal"),this.triggerAutoReveal())},o.getItemPercentages=function(){for(var t=this._canvasWidth*this._canvasHeight/(this._gridSize*this._gridSize)/(this._itemRows*this._itemCols),e=[],i=0;i<this._itemScratchGrids.length;i++){var s=this._itemScratchGrids[i].size,r=Math.min(100,s/t*100);e.push(r)}return e},o.forceReveal=function(){this.triggerAutoReveal()},o.enableScratching=function(){this._isEnabled=!0,console.log("[Scratchticket] Scratching enabled")},o.disableScratching=function(){this._isEnabled=!1,this._isTouching=!1,this._lastTouchPos=null,console.log("[Scratchticket] Scratching disabled")},o.resetScratchCard=function(){if(console.log("[Scratchticket] ===== RESET SCRATCH CARD START ====="),this._currentPath.length=0,this._isTouching=!1,this._lastTouchPos=null,this._needsGraphicsFlush=!1,this._autoRevealTriggered=!1,this._scratchCompleteEmitted=!1,this._scratchGrid.clear(),this._isEnabled=!1,this._itemScratchGrids.forEach((function(t){return t.clear()})),this._totalScratchDistance=0,this._lastDustSpawnTime=0,this.clearAllDust(),this.scratchLayerSprite){this.scratchLayerSprite.node.active=!0;var t=this.scratchLayerSprite;t.node.setScale(g.ONE),t.color&&t.color.set(255,255,255,255),console.log("[Scratchticket] Scratch layer sprite reset to default state")}this.maskGraphics&&(this.maskGraphics.clear(),this.maskGraphics.lineWidth=this.brushSize,this.maskGraphics.strokeColor=S.WHITE,this.maskGraphics.fillColor=S.WHITE,console.log("[Scratchticket] Mask graphics cleared and reset")),this.initializeScratchMask(),console.log("[Scratchticket] Mask state re-initialized"),this.setupScratchLayerMask(),console.log("[Scratchticket] Mask component re-setup with inverted="+this.invertMask),console.log("[Scratchticket] ===== RESET SCRATCH CARD COMPLETE =====")},o.triggerAutoReveal=function(){var t,e=this;if(!this._autoRevealTriggered){this._autoRevealTriggered=!0,this._isTouching=!1,this.enableDebug&&console.log("[Scratchticket] Auto reveal triggered - all items above 28%");var i=this.getItemPercentages(),s=i.reduce((function(t,e){return t+e}),0)/i.length;null==(t=w.instance)||t.emit(D.SCRATCH_THRESHOLD_REACHED,{percentage:s}),this.revealScratchLayer(),this.scheduleOnce((function(){e.emitScratchComplete()}),.3)}},o.revealScratchLayer=function(){this.maskGraphics&&this.maskGraphics.clear(),this.scratchLayerSprite&&(this.scratchLayerSprite.node.active=!1)},o.emitScratchComplete=function(){var t;this._scratchCompleteEmitted||(this._scratchCompleteEmitted=!0,null==(t=w.instance)||t.emit(D.SCRATCH_COMPLETE))},o.setupDustContainer=function(){console.log("[Scratchticket] setupDustContainer() called"),this.dustContainer?console.log("[Scratchticket] Dust container already assigned:",this.dustContainer.name):(this.dustContainer=this.node,console.log("[Scratchticket] Dust container set to main node"))},o.setupObjectPool=function(){if(console.log("[Scratchticket] setupObjectPool() called"),console.log("[Scratchticket] dustPrefab:",this.dustPrefab),this.dustPrefab){var t=new c("DustPool");console.log("[Scratchticket] Created poolNode:",t),t.setParent(this.node),this._dustPool=t.addComponent(T),console.log("[Scratchticket] Added ObjectPool component:",this._dustPool),this._dustPool.usePrefab=!0,this._dustPool.prefab=this.dustPrefab,this._dustPool.initCount=this.poolInitSize,console.log("[Scratchticket] Before initializePool()");try{this._dustPool.initializePool(),console.log("[Scratchticket] initializePool() completed successfully")}catch(t){console.error("[Scratchticket] Error in initializePool():",t)}console.log("[Scratchticket] Final _dustPool state:",this._dustPool),console.log("[Scratchticket] ObjectPool initialized with",this.poolInitSize,"objects")}else console.error("[Scratchticket] Dust prefab not assigned!")},o.spawnDustAlongPath=function(t,e){for(var i=f.distance(t,e),s=Math.max(1,Math.floor(i/(2*this.brushSize))),r=Math.min(s,3),o=0;o<=r;o++){var a=o/r,n=new g(t.x+(e.x-t.x)*a,t.y+(e.y-t.y)*a,0);this.isPositionNewlyScratchable(n)&&this.spawnDustAtPosition(n)}},o.isPositionNewlyScratchable=function(t){for(var e=this.brushSize/2,i=Math.ceil(e/this._gridSize),s=Math.floor(t.x/this._gridSize),r=Math.floor(t.y/this._gridSize),o=0,a=0,n=-i;n<=i;n++)for(var c=-i;c<=i;c++){var h=s+n+","+(r+c);a++,this._scratchGrid.has(h)||o++}var l=o>0;return console.log("[DEBUG] isPositionNewlyScratchable:",{pos:{x:t.x,y:t.y},centerGrid:{x:s,y:r},newCells:o,totalCells:a,result:l}),l},o.spawnDustAtPosition=function(t){if(this._dustPool){if(!(this._dustPool.activeCount>=this.maxActiveDust))for(var e=b(this.minDustPerSpawn,this.maxDustPerSpawn+1),i=0;i<e;i++){var s=this._dustPool.getObject();if(s){var r=(i-(e-1)/2)*this.dustSpreadX,o=b(-this.dustSpreadY,this.dustSpreadY),a=new g(t.x+r,t.y+o,0);if(console.log("[Scratchticket] Dust particle",i,"final position:",a),s.isValid)this.spawnDustAtPositionWithNode(s,a);else{console.error("[Scratchticket] Dust node is invalid, creating new one");var n=v(this.dustPrefab);if(!n){console.error("[Scratchticket] Failed to create new dust node");continue}s.destroy(),this.spawnDustAtPositionWithNode(n,a)}}else console.warn("[Scratchticket] Failed to get dust node from pool")}}else console.warn("[Scratchticket] Dust pool not initialized")},o.spawnDustAtPositionWithNode=function(t,e){var i=this;if(console.log("[Scratchticket] spawnDustAtPositionWithNode() called"),t)if(this.dustContainer){t.setParent(this.dustContainer);var s=t.getComponent(P);if(s){s.reset(),console.log("[Scratchticket] Dust component reset completed");var r=s.applyRandomSpawnOffset(e);t.setPosition(r),console.log("[Scratchticket] Applied random spawn offset, final position:",r),s.applyRandomScale(),console.log("[Scratchticket] Applied random scale to dust particle"),t.active=!0,this.applyTextureToDust(t,r),s.fall((function(){i.node&&i.node.isValid&&t&&t.isValid&&i._dustPool&&i._dustPool.returnObject(t)})),console.log("[Scratchticket] Spawned dust at position:",r)}else console.error("[Scratchticket] Dust component not found on dust node")}else console.error("[Scratchticket] dustContainer is null");else console.error("[Scratchticket] dustNode is null")},o.applyTextureToDust=function(t,e){if(this.scratchLayerSprite&&this.scratchLayerSprite.spriteFrame){var i=this.scratchLayerSprite.spriteFrame.texture;if(i){var s=this.scratchLayerSprite.node.getComponent(u);if(s){var r=s.contentSize,o=r.width,a=r.height,n=(e.x+o/2)/o,c=(e.y+a/2)/a,h=Math.max(0,Math.min(1,n)),p=Math.max(0,Math.min(1,c));if(h<0||h>1||p<0||p>1)this.enableDebug&&console.warn("[Scratchticket] UV coordinates out of bounds:",{u:h,v:p});else{var d=this.createDustSpriteFrame(i,h,p);if(d){var m=t.getComponent(l);m&&(m.spriteFrame=d)}}}else console.error("[Scratchticket] UITransform not found on scratch layer sprite")}else this.enableDebug&&console.warn("[Scratchticket] No texture available on sprite frame")}else this.enableDebug&&console.warn("[Scratchticket] No scratch layer sprite or sprite frame available for texture sampling")},o.createDustSpriteFrame=function(t,e,i){try{var s=t.width,r=t.height,o=b(-this.brushSize,this.brushSize),a=b(-this.brushSize,this.brushSize),n=Math.floor(e*s)+o-this.dustPixelSize/2,c=Math.floor((1-i)*r)+a-this.dustPixelSize/2,h=this.dustPixelSize/2,l=Math.max(0,n-h),u=Math.max(0,c-h),p=Math.min(this.dustPixelSize,s-l),d=Math.min(this.dustPixelSize,r-u);if(p<=0||d<=0)return null;var m=new _(l,u,p,d),f=new y;return f.texture=t,f.rect=m,f}catch(t){return console.error("[Scratchticket] Error creating dust sprite frame:",t),null}},o.clearAllDust=function(){console.log("[Scratchticket] clearAllDust() called"),this._dustPool?(this._dustPool.reset(),console.log("[Scratchticket] Dust pool reset completed")):console.warn("[Scratchticket] No dust pool to clear")},e}(k)).prototype,"dustPrefab",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=e(q.prototype,"dustContainer",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=e(q.prototype,"brushSize",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 22}}),$=e(q.prototype,"enableDebug",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),tt=e(q.prototype,"invertMask",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),et=e(q.prototype,"maskGraphics",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),it=e(q.prototype,"scratchLayerSprite",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),st=e(q.prototype,"rewardLayer",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rt=e(q.prototype,"minMoveDistance",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),ot=e(q.prototype,"dustPixelSize",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 16}}),at=e(q.prototype,"dustSpawnInterval",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),nt=e(q.prototype,"maxActiveDust",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 80}}),ct=e(q.prototype,"dustLifetime",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2.5}}),ht=e(q.prototype,"poolInitSize",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),lt=e(q.prototype,"minDustPerSpawn",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),ut=e(q.prototype,"maxDustPerSpawn",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),pt=e(q.prototype,"autoRevealThreshold",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 70}}),dt=e(q.prototype,"itemRevealThreshold",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 70}}),mt=e(q.prototype,"dustSpreadX",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 40}}),ft=e(q.prototype,"dustSpreadY",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),Q=q))||Q));o._RF.pop()}}}));

System.register("chunks:///_virtual/SettingsManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts"],(function(t){var e,n,s,i,a,_,o,r;return{setters:[function(t){e=t.inheritsLoose,n=t.createClass},function(t){s=t.cclegacy,i=t._decorator,a=t.director,_=t.sys,o=t.Component},function(t){r=t.GameConfig}],execute:function(){var E,l;s._RF.push({},"b2c3dTl9qeJAbze8SNFZ4kB","SettingsManager",void 0);var u=i.ccclass;t("SettingsManager",u("SettingsManager")(((l=function(t){function s(){for(var e,n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))||this)._bgmVolume=r.instance.DEFAULT_BGM_VOLUME,e._sfxVolume=r.instance.DEFAULT_SFX_VOLUME,e._bgmEnabled=r.instance.BGM_ENABLED_DEFAULT,e._sfxEnabled=r.instance.SFX_ENABLED_DEFAULT,e._autoPlaySpeed=r.instance.AUTO_PLAY_SPEED_DEFAULT,e._currentBalance=r.instance.STARTING_BALANCE,e._currentBet=r.instance.BET_AMOUNTS[r.instance.DEFAULT_BET_INDEX],e._totalGamesPlayed=0,e._totalWins=0,e._totalWinnings=0,e._biggestWin=0,e}e(s,t);var i=s.prototype;return i.onLoad=function(){if(s._instance)return console.warn("Multiple SettingsManager instances detected!"),void this.destroy();s._instance=this,a.addPersistRootNode(this.node),this.loadSettings(),console.log("SettingsManager initialized and persisted across scenes")},i.onDestroy=function(){s._instance===this&&(s._instance=null)},i.loadSettings=function(){var t=r.instance;this._bgmVolume=this.loadNumber(t.STORAGE_KEYS.BGM_VOLUME,t.DEFAULT_BGM_VOLUME),this._sfxVolume=this.loadNumber(t.STORAGE_KEYS.SFX_VOLUME,t.DEFAULT_SFX_VOLUME),this._bgmEnabled=this.loadBoolean(t.STORAGE_KEYS.BGM_ENABLED,t.BGM_ENABLED_DEFAULT),this._sfxEnabled=this.loadBoolean(t.STORAGE_KEYS.SFX_ENABLED,t.SFX_ENABLED_DEFAULT),this._autoPlaySpeed=this.loadNumber(t.STORAGE_KEYS.AUTO_PLAY_SPEED,t.AUTO_PLAY_SPEED_DEFAULT),this._currentBalance=this.loadNumber(t.STORAGE_KEYS.BALANCE,t.STARTING_BALANCE),this._currentBet=this.loadNumber(t.STORAGE_KEYS.CURRENT_BET,t.BET_AMOUNTS[t.DEFAULT_BET_INDEX]),this._totalGamesPlayed=this.loadNumber(t.STORAGE_KEYS.TOTAL_GAMES_PLAYED,0),this._totalWins=this.loadNumber(t.STORAGE_KEYS.TOTAL_WINS,0),this._totalWinnings=this.loadNumber(t.STORAGE_KEYS.TOTAL_WINNINGS,0),this._biggestWin=this.loadNumber(t.STORAGE_KEYS.BIGGEST_WIN,0),console.log("Settings loaded from storage")},i.saveSettings=function(){var t=r.instance;this.saveNumber(t.STORAGE_KEYS.BGM_VOLUME,this._bgmVolume),this.saveNumber(t.STORAGE_KEYS.SFX_VOLUME,this._sfxVolume),this.saveBoolean(t.STORAGE_KEYS.BGM_ENABLED,this._bgmEnabled),this.saveBoolean(t.STORAGE_KEYS.SFX_ENABLED,this._sfxEnabled),this.saveNumber(t.STORAGE_KEYS.AUTO_PLAY_SPEED,this._autoPlaySpeed),this.saveNumber(t.STORAGE_KEYS.BALANCE,this._currentBalance),this.saveNumber(t.STORAGE_KEYS.CURRENT_BET,this._currentBet),this.saveNumber(t.STORAGE_KEYS.TOTAL_GAMES_PLAYED,this._totalGamesPlayed),this.saveNumber(t.STORAGE_KEYS.TOTAL_WINS,this._totalWins),this.saveNumber(t.STORAGE_KEYS.TOTAL_WINNINGS,this._totalWinnings),this.saveNumber(t.STORAGE_KEYS.BIGGEST_WIN,this._biggestWin),console.log("Settings saved to storage")},i.resetSettings=function(){var t=r.instance;this._bgmVolume=t.DEFAULT_BGM_VOLUME,this._sfxVolume=t.DEFAULT_SFX_VOLUME,this._bgmEnabled=t.BGM_ENABLED_DEFAULT,this._sfxEnabled=t.SFX_ENABLED_DEFAULT,this._autoPlaySpeed=t.AUTO_PLAY_SPEED_DEFAULT,this.saveSettings(),console.log("Settings reset to default")},i.resetProgress=function(){var t=r.instance;this._currentBalance=t.STARTING_BALANCE,this._currentBet=t.BET_AMOUNTS[t.DEFAULT_BET_INDEX],this._totalGamesPlayed=0,this._totalWins=0,this._totalWinnings=0,this._biggestWin=0,this.saveSettings(),console.log("Game progress reset")},i.loadNumber=function(t,e){var n=_.localStorage.getItem(t);if(null==n)return e;var s=parseFloat(n);return isNaN(s)?e:s},i.loadBoolean=function(t,e){var n=_.localStorage.getItem(t);return null==n?e:"true"===n},i.loadString=function(t,e){var n=_.localStorage.getItem(t);return null!=n?n:e},i.saveNumber=function(t,e){_.localStorage.setItem(t,e.toString())},i.saveBoolean=function(t,e){_.localStorage.setItem(t,e.toString())},i.saveString=function(t,e){_.localStorage.setItem(t,e)},i.recordGame=function(t){this._totalGamesPlayed++,t>0&&(this._totalWins++,this._totalWinnings+=t,t>this._biggestWin&&(this._biggestWin=t)),this.saveSettings()},i.getStatistics=function(){return{totalGamesPlayed:this._totalGamesPlayed,totalWins:this._totalWins,totalWinnings:this._totalWinnings,biggestWin:this._biggestWin,winRate:this.winRate,currentBalance:this._currentBalance}},n(s,[{key:"bgmVolume",get:function(){return this._bgmVolume},set:function(t){this._bgmVolume=Math.max(0,Math.min(1,t)),this.saveNumber(r.instance.STORAGE_KEYS.BGM_VOLUME,this._bgmVolume)}},{key:"sfxVolume",get:function(){return this._sfxVolume},set:function(t){this._sfxVolume=Math.max(0,Math.min(1,t)),this.saveNumber(r.instance.STORAGE_KEYS.SFX_VOLUME,this._sfxVolume)}},{key:"bgmEnabled",get:function(){return this._bgmEnabled},set:function(t){this._bgmEnabled=t,this.saveBoolean(r.instance.STORAGE_KEYS.BGM_ENABLED,this._bgmEnabled)}},{key:"sfxEnabled",get:function(){return this._sfxEnabled},set:function(t){this._sfxEnabled=t,this.saveBoolean(r.instance.STORAGE_KEYS.SFX_ENABLED,this._sfxEnabled)}},{key:"autoPlaySpeed",get:function(){return this._autoPlaySpeed},set:function(t){var e=r.instance;this._autoPlaySpeed=Math.max(e.AUTO_PLAY_SPEED_MIN,Math.min(e.AUTO_PLAY_SPEED_MAX,t)),this.saveNumber(e.STORAGE_KEYS.AUTO_PLAY_SPEED,this._autoPlaySpeed)}},{key:"currentBalance",get:function(){return this._currentBalance},set:function(t){var e=r.instance;this._currentBalance=Math.max(0,Math.min(e.MAX_BALANCE,t)),this.saveNumber(e.STORAGE_KEYS.BALANCE,this._currentBalance)}},{key:"currentBet",get:function(){return this._currentBet},set:function(t){r.instance.isValidBetAmount(t)&&(this._currentBet=t,this.saveNumber(r.instance.STORAGE_KEYS.CURRENT_BET,this._currentBet))}},{key:"totalGamesPlayed",get:function(){return this._totalGamesPlayed}},{key:"totalWins",get:function(){return this._totalWins}},{key:"totalWinnings",get:function(){return this._totalWinnings}},{key:"biggestWin",get:function(){return this._biggestWin}},{key:"winRate",get:function(){return this._totalGamesPlayed>0?this._totalWins/this._totalGamesPlayed*100:0}}],[{key:"instance",get:function(){return s._instance}}]),s}(o))._instance=null,E=l))||E);s._RF.pop()}}}));

System.register("chunks:///_virtual/Singleton.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,n,o,i,r;return{setters:[function(e){t=e.inheritsLoose,n=e.createClass,o=e.assertThisInitialized},function(e){i=e.cclegacy,r=e.director}],execute:function(){e({ccsingleton:function(e){var o=null,i=function(i){function s(){return i.apply(this,arguments)||this}t(s,i);var c=s.prototype;return c.onLoad=function(){if(o&&o!==this)return console.warn("[ccsingleton] Multiple instances of "+e.name+" detected. Destroying new instance."),void(this.node&&this.node.isValid&&this.node.destroy());i.prototype.onLoad&&i.prototype.onLoad.call(this),o=this,r.addPersistRootNode(this.node)},c.onDestroy=function(){i.prototype.onDestroy&&i.prototype.onDestroy.call(this),o===this&&(o=null),r.removePersistRootNode(this.node)},n(s,null,[{key:"instance",get:function(){return o}}]),s}(e);return Object.setPrototypeOf(i,e),Object.defineProperty(i,"name",{value:e.name}),i},singleton:function(e){var i=null,r=function(r){function s(){var t;if(i)return console.warn("[singleton] Multiple instances of "+e.name+" detected. Returning existing instance."),i||o(t);for(var n=arguments.length,s=new Array(n),c=0;c<n;c++)s[c]=arguments[c];return t=r.call.apply(r,[this].concat(s))||this,(i=o(t))||o(t)}return t(s,r),n(s,null,[{key:"instance",get:function(){return i||(i=new s),i}}]),s}(e);return Object.setPrototypeOf(r,e),Object.defineProperty(r,"name",{value:e.name}),r}}),i._RF.push({},"fd54b2X+slJcreYIB2GeOx6","Singleton",void 0),i._RF.pop()}}}));

System.register("chunks:///_virtual/SpriteSkin.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,e,n,r,o,s,a,l,u,p,c;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,n=i.initializerDefineProperty,r=i.assertThisInitialized},function(i){o=i.cclegacy,s=i._decorator,a=i.Sprite,l=i.SpriteFrame,u=i.Color,p=i.warn,c=i.Component}],execute:function(){var h,S,f,m,k,b,g,d,y,v,C,D,w;o._RF.push({},"b8bccoh6h1LsLCtuk6DBzjA","SpriteSkin",void 0);var z=s.ccclass,F=s.property,L=s.menu;i("default",(h=L("Joy/Components/Skin/SpriteSkin"),S=F(a),f=F(l),m=F(l),k=F(u),z(b=h((d=t((g=function(i){function t(){for(var t,e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];return t=i.call.apply(i,[this].concat(o))||this,n(t,"item",d,r(t)),n(t,"isSprite",y,r(t)),n(t,"spriteSkin",v,r(t)),n(t,"spriteDefaultSkin",C,r(t)),n(t,"isColor",D,r(t)),n(t,"colorSkin",w,r(t)),t.idSkin=0,t}e(t,i);var o=t.prototype;return o.onLoad=function(){!this.item&&this.getComponent(a)&&(this.item=this.getComponent(a))},o.setSkin=function(i){if(i<0||i>this.countSkin())return p("wrong id skin "),void(this.spriteDefaultSkin&&(this.item.spriteFrame=this.spriteDefaultSkin));this.idSkin=i,this.isSprite&&this.item&&(this.spriteSkin[i]?this.item.spriteFrame=this.spriteSkin[i]:this.spriteDefaultSkin&&(this.item.spriteFrame=this.spriteDefaultSkin)),this.isColor&&this.item&&(this.item.color=this.colorSkin[i])},o.countSkin=function(){return this.isSprite&&this.item?this.spriteSkin.length:this.isColor&&this.item?this.colorSkin.length:void 0},o.randomSkin=function(){var i=this.getRandomInt(0,this.countSkin()-1);this.setSkin(i)},o.getRandomInt=function(i,t){return i=Math.ceil(i),t=Math.floor(t),Math.floor(Math.random()*(t-i+1))+i},t}(c)).prototype,"item",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y=t(g.prototype,"isSprite",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),v=t(g.prototype,"spriteSkin",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),C=t(g.prototype,"spriteDefaultSkin",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=t(g.prototype,"isColor",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=t(g.prototype,"colorSkin",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),b=g))||b)||b));o._RF.pop()}}}));

System.register("chunks:///_virtual/StartSceneController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameConfig.ts","./SettingsManager.ts","./AudioManager.ts"],(function(t){var e,n,i,o,a,r,s,l,c,u,g,d,h,f,p,b,m,y,v;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized,a=t.asyncToGenerator,r=t.regeneratorRuntime},function(t){s=t.cclegacy,l=t._decorator,c=t.Button,u=t.Node,g=t.ProgressBar,d=t.Label,h=t.Vec3,f=t.tween,p=t.director,b=t.Component},function(t){m=t.GameConfig},function(t){y=t.SettingsManager},function(t){v=t.AudioManager}],execute:function(){var S,B,L,w,x,N,M,C,P,T,k,z,E,G,_,A,R,O,F;s._RF.push({},"b9e8dPyX2x9jp8KGyw9Tl9q","StartSceneController",void 0);var I=l.ccclass,D=l.property;t("StartSceneController",(S=I("StartSceneController"),B=D(c),L=D(u),w=D(u),x=D(g),N=D(d),M=D(d),C=D(y),P=D(v),S((z=e((k=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,i(e,"startButton",z,o(e)),i(e,"titleNode",E,o(e)),i(e,"loadingPanel",G,o(e)),i(e,"loadingProgressBar",_,o(e)),i(e,"loadingText",A,o(e)),i(e,"versionLabel",R,o(e)),i(e,"settingsManager",O,o(e)),i(e,"audioManager",F,o(e)),e._isLoading=!1,e}n(e,t);var s=e.prototype;return s.onLoad=function(){console.log("StartSceneController loaded"),this.loadingPanel&&(this.loadingPanel.active=!0),this.titleNode&&(this.titleNode.active=!1),this.startButton&&(this.startButton.interactable=!1),this.versionLabel&&(this.versionLabel.string="v"+m.instance.GAME_VERSION),this.initializeButtons()},s.start=function(){this.settingsManager&&(this.settingsManager.loadSettings(),console.log("Settings loaded in start scene")),this.loadResources()},s.initializeButtons=function(){this.startButton&&this.startButton.node.on(c.EventType.CLICK,this.onStartButtonClicked,this)},s.loadResources=function(){var t=a(r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Loading resources..."),t.prev=1,this.loadingText&&(this.loadingText.string="Loading audio..."),!this.audioManager){t.next=7;break}return t.next=6,this.audioManager.preloadAllGameAudio();case 6:console.log("Audio preloaded");case 7:return t.next=9,this.simulateLoading();case 9:this.onLoadingComplete(),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),console.error("Error loading resources:",t.t0),this.onLoadingComplete();case 16:case"end":return t.stop()}}),t,this,[[1,12]])})));return function(){return t.apply(this,arguments)}}(),s.onLoadingComplete=function(){console.log("Loading complete - showing title"),this.loadingPanel&&(this.loadingPanel.active=!1),this.titleNode&&(this.titleNode.active=!0,this.playTitleAnimation()),this.startButton&&(this.startButton.interactable=!0)},s.playTitleAnimation=function(){this.titleNode&&(this.titleNode.setScale(h.ZERO),f(this.titleNode).to(.5,{scale:new h(1.2,1.2,1)},{easing:"backOut"}).to(.2,{scale:h.ONE},{easing:"sineOut"}).start())},s.onStartButtonClicked=function(){var t=this;this._isLoading||(console.log("Start button clicked - Entering game scene..."),this.audioManager&&this.audioManager.playSFXByName("button"),this.titleNode?f(this.titleNode).to(.3,{scale:h.ZERO},{easing:"backIn"}).call((function(){t.loadGameScene()})).start():this.loadGameScene())},s.loadGameScene=function(){var t=this;this._isLoading=!0,this.startButton&&(this.startButton.interactable=!1);try{console.log("Transitioning to game scene..."),p.loadScene("game",(function(e){e?(console.error("Failed to load game scene:",e),t._isLoading=!1,t.startButton&&(t.startButton.interactable=!0),t.titleNode&&t.titleNode.setScale(h.ONE)):console.log("Game scene loaded successfully")}))}catch(t){console.error("Error loading game scene:",t),this._isLoading=!1}},s.simulateLoading=function(){var t=a(r().mark((function t(){var e,n,i,o,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=10,n=100,i=0;case 3:if(!(i<=e)){t.next=13;break}if(o=i/e,this.loadingProgressBar&&(this.loadingProgressBar.progress=o),this.loadingText&&(a=Math.floor(100*o),this.loadingText.string="Loading... "+a+"%"),!(i<e)){t.next=10;break}return t.next=10,this.wait(n);case 10:i++,t.next=3;break;case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.wait=function(t){return new Promise((function(e){setTimeout((function(){return e()}),t)}))},e}(b)).prototype,"startButton",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=e(k.prototype,"titleNode",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(k.prototype,"loadingPanel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(k.prototype,"loadingProgressBar",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(k.prototype,"loadingText",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=e(k.prototype,"versionLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=e(k.prototype,"settingsManager",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=e(k.prototype,"audioManager",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=k))||T));s._RF.pop()}}}));

System.register("chunks:///_virtual/TicketGameController.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Scratchticket.ts","./EventManager.ts","./GameEvents.ts","./LocalGameController.ts","./ScratchCardItemView.ts","./WinPopup.ts"],(function(e){var n,t,i,o,r,c,s,l,a,h,u,g,p,f,m,d,k,T;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,c=e._decorator,s=e.sp,l=e.Prefab,a=e.Node,h=e.instantiate,u=e.Vec3,g=e.Component},function(e){p=e.Scratchticket},function(e){f=e.EventManager},function(e){m=e.GameEvents},function(e){d=e.LocalGameController},function(e){k=e.ScratchCardItemView},function(e){T=e.WinPopup}],execute:function(){var S,C,G,v,w,E,R,b,y,L,W,I,P,A,M;r._RF.push({},"020fflqy1hEL6qBLD6fUnAQ","TicketGameController",void 0);var z=c.ccclass,H=c.property;e("TicketGameController",(S=z("TicketGameController"),C=H(p),G=H([k]),v=H({type:s.Skeleton,tooltip:"Spine animation node to play before allowing scratch"}),w=H({type:s.Skeleton,tooltip:"Spine animation for money increase effect"}),E=H({type:l,tooltip:"Win popup prefab to show win result"}),R=H({type:a,tooltip:"Parent node to attach win popup"}),S((L=n((y=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return n=e.call.apply(e,[this].concat(r))||this,i(n,"scratchTicket",L,o(n)),i(n,"scratchTickets",W,o(n)),i(n,"effectStartSkelen",I,o(n)),i(n,"spineIncreaseMoneySkelen",P,o(n)),i(n,"winPrefab",A,o(n)),i(n,"popupContainer",M,o(n)),n.currentResultLines=[],n.currentWinningLines=[],n.hasPendingWinHighlight=!1,n.hasResultAssigned=!1,n.currentWinPopupInstance=null,n.currentGameResult=null,n}t(n,e);var r=n.prototype;return r.onLoad=function(){this.scratchTicket&&this.scratchTicket.disableScratching(),this.effectStartSkelen&&(this.effectStartSkelen.node.active=!1),this.spineIncreaseMoneySkelen&&(this.spineIncreaseMoneySkelen.node.active=!1),f.instance?(f.instance.on(m.GAME_RESULT_GENERATED,this.onGameResultGenerated,this),f.instance.on(m.SCRATCH_ITEM_THRESHOLD_REACHED,this.onScratchItemThresholdReached,this),f.instance.on(m.SCRATCH_THRESHOLD_REACHED,this.onScratchThresholdReached,this),f.instance.on(m.SCRATCH_COMPLETE,this.onScratchComplete,this),console.log("[TicketGameController] Event listeners registered for GAME_RESULT_GENERATED, SCRATCH_ITEM_THRESHOLD_REACHED, SCRATCH_THRESHOLD_REACHED, and SCRATCH_COMPLETE")):console.warn("[TicketGameController] EventManager not available")},r.onDestroy=function(){f.instance&&(f.instance.targetOff(this),console.log("[TicketGameController] Event listeners cleaned up"))},r.onGameResultGenerated=function(e){console.log("[TicketGameController] Received game result:",e.result),e&&e.result?(this.currentResultLines=e.result.resultLines||[],this.currentWinningLines=e.result.winningLines||[],this.hasPendingWinHighlight=this.currentWinningLines.length>0,this.hasResultAssigned=!0,this.currentGameResult=e.result,console.log("[TicketGameController] Received "+this.currentResultLines.length+" result lines (should be 9):",this.currentResultLines),console.log("[TicketGameController] Winning lines: "+this.currentWinningLines.length,this.currentWinningLines),this.configureScratcher(e.result),this.populateScratchTickets(),this.playStartEffectAndEnableScratching()):console.error("[TicketGameController] Invalid game result data")},r.configureScratcher=function(e){var n;e&&e.prizes&&9===e.prizes.length?(console.log("[TicketGameController] Configuring scratcher with prizes:",e.prizes),this.scratchTicket?this.setScratcherPrizes(this.scratchTicket,e.prizes):console.warn("[TicketGameController] Primary scratch ticket not assigned"),this.resetScratchTickets()):console.error("[TicketGameController] Invalid game result or prizes array. Expected 9 prizes, got:",null==e||null==(n=e.prizes)?void 0:n.length)},r.setScratcherPrizes=function(e,n){"function"==typeof e.setPrizeData?(e.setPrizeData(n),console.log("[TicketGameController] Prize data set on scratcher")):(console.warn("[TicketGameController] Scratcher does not have setPrizeData method"),this.configureScratcherAlternative(e,n))},r.configureScratcherAlternative=function(e,n){console.log("[TicketGameController] Using alternative prize configuration method"),e.rewardLayer&&console.log("[TicketGameController] Found reward layer, configuring prizes")},r.setPrizeItemData=function(e,n){var t=this.currentResultLines[n];!Number.isInteger(t)||t<1?console.warn("[TicketGameController] Skipping invalid display number at index "+n+":",t):e.setNum(t)},r.processWinningLines=function(){var e=this;this.scratchTickets&&0!==this.scratchTickets.length?this.currentWinningLines&&0!==this.currentWinningLines.length?(console.log("[processWinningLines] Processing "+this.currentWinningLines.length+" winning lines"),this.currentWinningLines.forEach((function(n,t){var i=n.positions.map((function(n){return e.currentResultLines[n]||0})).join(",");console.log("Line "+(n.lineIndex+1)+" WIN: "+i+" (positions: "+n.positions.join(",")+")"),n.positions.forEach((function(t){if(t>=0&&t<e.scratchTickets.length){var i=e.scratchTickets[t];i?(console.log("Highlighting position "+t+" for line "+(n.lineIndex+1)+" win"),i.setWin(.5)):console.warn("No ScratchCardItemView component found at position "+t)}else console.error("Invalid position "+t+" (valid range: 0-"+(e.scratchTickets.length-1)+")")})),console.log("Completed highlighting for winning line "+(n.lineIndex+1))})),console.log("Winning line highlighting complete - highlighted positions from "+this.currentWinningLines.length+" winning lines")):console.log("[processWinningLines] No winning lines to process"):console.warn("[processWinningLines] No scratch tickets available")},r.onScratchComplete=function(){var e=this;this.hasResultAssigned?(this.populateScratchTickets(),this.hasPendingWinHighlight?(console.log("[TicketGameController] Scratch complete received - scheduling win popup"),this.hasPendingWinHighlight=!1,this.scheduleOnce((function(){e.showWinPopup()}),.4)):console.log("[TicketGameController] Scratch complete received with no pending win highlight - NO AUTO RESET, wait for buy button")):console.warn("[TicketGameController] Scratch complete received before result assignment")},r.onScratchItemThresholdReached=function(e){if(e){var n=e.index,t=e.percentage;if(!Number.isInteger(n)||n<0||n>=this.scratchTickets.length)console.warn("[TicketGameController] Received invalid scratch item index "+n+" for threshold event");else if(this.hasResultAssigned){var i=this.scratchTickets[n];if(i){this.populateScratchTickets();var o="number"==typeof t&&Number.isFinite(t)?t.toFixed(1):"unknown";console.log("[TicketGameController] Scratch item "+n+" reached "+o+"% - highlighting win candidate"),this.currentWinningLines.some((function(e){return e.positions.some((function(e){return e===n}))}))&&i.setWin(.5)}else console.warn("[TicketGameController] Scratch item threshold event for index "+n+" with no prize view")}else console.warn("[TicketGameController] Scratch item threshold reached before result assignment")}},r.onScratchThresholdReached=function(e){var n;if(this.hasResultAssigned)if(this.hasPendingWinHighlight){this.populateScratchTickets();var t=null!=(null==e?void 0:e.percentage)?null!=(n=null==e.percentage.toFixed?void 0:e.percentage.toFixed(1))?n:""+e.percentage:"unknown";console.log("[TicketGameController] Scratch threshold reached at "+t+"% - highlighting wins now"),this.processWinningLines()}else console.log("[TicketGameController] Scratch threshold reached with no pending win highlight");else console.warn("[TicketGameController] Scratch threshold reached before result assignment")},r.populateScratchTickets=function(){var e=this;this.scratchTickets&&0!==this.scratchTickets.length&&(this.currentResultLines&&9===this.currentResultLines.length?this.scratchTickets.forEach((function(n,t){n&&e.setPrizeItemData(n,t)})):console.warn("[populateScratchTickets] Invalid result lines, expected 9 numbers"))},r.resetScratchTickets=function(){this.scratchTickets&&this.scratchTickets.forEach((function(e){null==e||e.resetToDefault()}))},r.playStartEffectAndEnableScratching=function(){var e=this;if(!this.effectStartSkelen)return console.warn("[TicketGameController] No effect start skeleton assigned, enabling scratching immediately"),void this.enableScratching();this.effectStartSkelen.node.active=!0,this.effectStartSkelen.setAnimation(0,"animation",!1),console.log("[TicketGameController] Start effect animation playing"),this.scheduleOnce((function(){console.log("[TicketGameController] Start effect complete, enabling scratching"),e.effectStartSkelen.node.active=!1,e.enableScratching()}),1)},r.enableScratching=function(){this.scratchTicket&&(this.scratchTicket.enableScratching(),console.log("[TicketGameController] Scratching enabled"))},r.showWinPopup=function(){var e=this;if(!this.winPrefab)return console.warn("[TicketGameController] No win prefab assigned"),void this.scheduleOnce((function(){e.showIncreaseMoneyEffect()}),1);if(this.currentGameResult){this.currentWinPopupInstance=h(this.winPrefab);var n=this.popupContainer||this.node;this.currentWinPopupInstance.setParent(n),this.currentWinPopupInstance.setPosition(u.ZERO);var t=this.currentWinPopupInstance.getComponent(T);t&&(null==t.configure||t.configure(this.currentGameResult,this.currentWinningLines,this.scratchTickets)),console.log("[TicketGameController] Win popup shown");var i=t.delayClosePopup||2e3;this.scheduleOnce((function(){e.closeWinPopup()}),i/1e3)}else console.error("[TicketGameController] No current game result")},r.closeWinPopup=function(){this.currentWinPopupInstance&&(this.currentWinPopupInstance.destroy(),this.currentWinPopupInstance=null,console.log("[TicketGameController] Win popup closed")),this.showIncreaseMoneyEffect()},r.showIncreaseMoneyEffect=function(){var e=this;if(console.log("[TicketGameController] showIncreaseMoneyEffect() called"),!this.spineIncreaseMoneySkelen)return console.warn("[TicketGameController] No spine increase money skeleton assigned - updating balance immediately"),void this.updateBalance();this.spineIncreaseMoneySkelen.node.active=!0,this.spineIncreaseMoneySkelen.setAnimation(0,"sjjb",!1),console.log("[TicketGameController] Spine increase money animation playing"),this.scheduleOnce((function(){console.log("[TicketGameController] Animation complete, hiding node"),e.spineIncreaseMoneySkelen.node.active=!1,e.updateBalance()}),1.2)},r.updateBalance=function(){var e,n=this;this.currentGameResult?(console.log("[TicketGameController] Requesting balance update with win: "+this.currentGameResult.totalWin),null==(e=f.instance)||e.emit(m.WIN_AMOUNT_READY,{winAmount:this.currentGameResult.totalWin}),this.scheduleOnce((function(){n.enableBuyButton()}),.5)):console.warn("[TicketGameController] No game result for balance update")},r.enableBuyButton=function(){console.log("[TicketGameController] Balance animation should be completing, GameManager will enable button")},r.resetForNextGame=function(){console.log("[TicketGameController] ===== RESETTING FOR NEXT GAME ====="),this.currentResultLines=[],this.currentWinningLines=[],this.hasPendingWinHighlight=!1,this.hasResultAssigned=!1,this.currentGameResult=null,console.log("[TicketGameController] State cleared"),this.effectStartSkelen&&(this.effectStartSkelen.node.active=!1,console.log("[TicketGameController] Effect start skeleton hidden")),this.spineIncreaseMoneySkelen&&(this.spineIncreaseMoneySkelen.node.active=!1,console.log("[TicketGameController] Spine increase money skeleton hidden")),this.currentWinPopupInstance&&(this.currentWinPopupInstance.destroy(),this.currentWinPopupInstance=null,console.log("[TicketGameController] Win popup destroyed")),this.resetScratchTickets(),console.log("[TicketGameController] Scratch ticket views reset"),this.scratchTicket?(console.log("[TicketGameController] Calling scratchTicket.resetScratchCard()..."),this.scratchTicket.resetScratchCard(),console.log("[TicketGameController] scratchTicket.resetScratchCard() completed")):console.error("[TicketGameController] scratchTicket is NULL!"),console.log("[TicketGameController] ===== RESET COMPLETE - READY FOR NEXT ROUND =====")},r.testWinningLineHighlighting=function(e){void 0===e&&(e=4),console.log("[TicketGameController] Testing winning line highlighting for line "+(e+1));var n=d.instance;if(n){var t=n.generateDemoLineWin(10,e);console.log("[TicketGameController] Generated demo result for testing:",t),this.currentResultLines=t.resultLines,this.currentWinningLines=t.winningLines,console.log("[TicketGameController] Set test result lines: "+this.currentResultLines.length+" numbers (should be 9)"),console.log("[TicketGameController] Set test winning lines: "+this.currentWinningLines.length+" lines"),this.processWinningLines(),console.log("[TicketGameController] Test highlighting complete - check console for detailed logs")}else console.error("[TicketGameController] LocalGameController instance not available for testing")},n}(g)).prototype,"scratchTicket",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=n(y.prototype,"scratchTickets",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=n(y.prototype,"effectStartSkelen",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=n(y.prototype,"spineIncreaseMoneySkelen",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=n(y.prototype,"winPrefab",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(y.prototype,"popupContainer",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=y))||b));r._RF.pop()}}}));

System.register("chunks:///_virtual/UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameManager.ts","./GameConfig.ts","./SettingsManager.ts","./AudioManager.ts"],(function(e){var t,n,i,o,a,l,r,u,s,c,h,g,d,p,b,f,m,P,y,B,w,S;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,i=e.createClass,o=e.initializerDefineProperty,a=e.assertThisInitialized},function(e){l=e.cclegacy,r=e._decorator,u=e.Node,s=e.ProgressBar,c=e.Label,h=e.Button,g=e.Slider,d=e.Toggle,p=e.Animation,b=e.Vec3,f=e.tween,m=e.Component},function(e){P=e.GameManager,y=e.GameState},function(e){B=e.GameConfig},function(e){w=e.SettingsManager},function(e){S=e.AudioManager}],execute:function(){var C,T,v,A,I,L,z,E,_,M,k,x,G,U,F,D,O,R,X,K,N,V,Z,$,j,H,Y,W,q,J,Q,ee,te,ne,ie,oe,ae,le,re,ue,se,ce,he,ge,de,pe,be,fe,me,Pe,ye,Be,we,Se,Ce,Te,ve,Ae,Ie,Le,ze;l._RF.push({},"f8f181kd01EjLZ7uw9msu21","UIManager",void 0);var Ee=r.ccclass,_e=r.property;e("UIManager",(C=Ee("UIManager"),T=_e(u),v=_e(u),A=_e(u),I=_e(u),L=_e(u),z=_e(s),E=_e(c),_=_e(c),M=_e(c),k=_e(c),x=_e(h),G=_e(h),U=_e(h),F=_e(h),D=_e(h),O=_e(h),R=_e(h),X=_e(h),K=_e(g),N=_e(u),V=_e(d),Z=_e(g),$=_e(d),j=_e(d),H=_e(g),Y=_e(g),W=_e(u),q=_e(c),J=_e(p),C((te=t((ee=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return t=e.call.apply(e,[this].concat(i))||this,o(t,"loadingPanel",te,a(t)),o(t,"menuPanel",ne,a(t)),o(t,"gamePanel",ie,a(t)),o(t,"settingsPanel",oe,a(t)),o(t,"recordPanel",ae,a(t)),o(t,"loadingProgressBar",le,a(t)),o(t,"loadingText",re,a(t)),o(t,"balanceLabel",ue,a(t)),o(t,"betLabel",se,a(t)),o(t,"winLabel",ce,a(t)),o(t,"playButton",he,a(t)),o(t,"autoPlayButton",ge,a(t)),o(t,"maxBetButton",de,a(t)),o(t,"menuButton",pe,a(t)),o(t,"recordButton",be,a(t)),o(t,"settingsButton",fe,a(t)),o(t,"betIncreaseButton",me,a(t)),o(t,"betDecreaseButton",Pe,a(t)),o(t,"betSlider",ye,a(t)),o(t,"autoPlayPanel",Be,a(t)),o(t,"autoPlayToggle",we,a(t)),o(t,"speedSlider",Se,a(t)),o(t,"soundToggle",Ce,a(t)),o(t,"musicToggle",Te,a(t)),o(t,"soundVolumeSlider",ve,a(t)),o(t,"musicVolumeSlider",Ae,a(t)),o(t,"winPopup",Ie,a(t)),o(t,"winAmountLabel",Le,a(t)),o(t,"winAnimation",ze,a(t)),t._currentBetIndex=B.instance.DEFAULT_BET_INDEX,t}n(t,e);var l=t.prototype;return l.onLoad=function(){this.initializeUI(),this.setupEventListeners()},l.start=function(){this.updateUI()},l.initializeUI=function(){this.hideAllPanels(),this.loadingPanel&&(this.loadingPanel.active=!0),this.betSlider&&(this.betSlider.progress=this._currentBetIndex/(this._betAmounts.length-1)),this.autoPlayPanel&&(this.autoPlayPanel.active=!1),this.winPopup&&(this.winPopup.active=!1)},l.setupEventListeners=function(){this.playButton&&this.playButton.node.on(h.EventType.CLICK,this.onPlayButtonClicked,this),this.autoPlayButton&&this.autoPlayButton.node.on(h.EventType.CLICK,this.onAutoPlayButtonClicked,this),this.maxBetButton&&this.maxBetButton.node.on(h.EventType.CLICK,this.onMaxBetButtonClicked,this),this.betIncreaseButton&&this.betIncreaseButton.node.on(h.EventType.CLICK,this.onBetIncreaseClicked,this),this.betDecreaseButton&&this.betDecreaseButton.node.on(h.EventType.CLICK,this.onBetDecreaseClicked,this),this.betSlider&&this.betSlider.node.on("slide",this.onBetSliderChanged,this),this.menuButton&&this.menuButton.on(h.EventType.CLICK,this.onMenuButtonClicked,this),this.recordButton&&this.recordButton.on(h.EventType.CLICK,this.onRecordButtonClicked,this),this.settingsButton&&this.settingsButton.on(h.EventType.CLICK,this.onSettingsButtonClicked,this),this.autoPlayToggle&&this.autoPlayToggle.node.on(d.EventType.TOGGLE,this.onAutoPlayToggleChanged,this),this.speedSlider&&this.speedSlider.node.on("slide",this.onSpeedSliderChanged,this),this.soundToggle&&this.soundToggle.node.on(d.EventType.TOGGLE,this.onSoundToggleChanged,this),this.musicToggle&&this.musicToggle.node.on(d.EventType.TOGGLE,this.onMusicToggleChanged,this)},l.hideAllPanels=function(){[this.loadingPanel,this.menuPanel,this.gamePanel,this.settingsPanel,this.recordPanel].forEach((function(e){e&&(e.active=!1)}))},l.showLoadingScreen=function(){this.hideAllPanels(),this.loadingPanel&&(this.loadingPanel.active=!0)},l.showMainMenu=function(){this.hideAllPanels(),this.menuPanel&&(this.menuPanel.active=!0)},l.showGameScreen=function(){this.hideAllPanels(),this.gamePanel&&(this.gamePanel.active=!0)},l.showSettingsPanel=function(){this.settingsPanel&&(this.settingsPanel.active=!0)},l.hideSettingsPanel=function(){this.settingsPanel&&(this.settingsPanel.active=!1)},l.showRecordPanel=function(){this.recordPanel&&(this.recordPanel.active=!0)},l.hideRecordPanel=function(){this.recordPanel&&(this.recordPanel.active=!1)},l.updateLoadingProgress=function(e,t){void 0===t&&(t=""),this.loadingProgressBar&&(this.loadingProgressBar.progress=e),this.loadingText&&t&&(this.loadingText.string=t)},l.updateUI=function(){var e=P.instance;if(e){if(this.balanceLabel&&(this.balanceLabel.string="$"+e.currentBalance.toFixed(2)),this.betLabel&&(this.betLabel.string="$"+e.currentBet),this.playButton){var t=e.gameState===y.READY&&e.currentBalance>=e.currentBet;this.playButton.interactable=t}if(this.autoPlayButton){var n=this.autoPlayButton.node.getComponentInChildren(c);n&&(n.string=e.isAutoPlay?"STOP AUTO":"AUTO PLAY")}}},l.showWinPopup=function(e){var t=this;this.winPopup&&(this.winAmountLabel&&(this.winAmountLabel.string="$"+e.toFixed(2)),this.winPopup.active=!0,this.winPopup.setScale(b.ZERO),f(this.winPopup).to(.3,{scale:b.ONE}).delay(2).to(.3,{scale:b.ZERO}).call((function(){t.winPopup.active=!1})).start(),this.winAnimation&&this.winAnimation.play())},l.onPlayButtonClicked=function(){var e,t;null==(e=P.instance)||e.startNewGame(),null==(t=P.instance)||t.playSFX("button")},l.onAutoPlayButtonClicked=function(){var e,t=P.instance;t&&(t.isAutoPlay=!t.isAutoPlay,this.updateUI()),null==(e=P.instance)||e.playSFX("button")},l.onMaxBetButtonClicked=function(){var e;this._currentBetIndex=this._betAmounts.length-1,this.updateBetAmount(),null==(e=P.instance)||e.playSFX("button")},l.onBetIncreaseClicked=function(){var e;this._currentBetIndex<this._betAmounts.length-1&&(this._currentBetIndex++,this.updateBetAmount()),null==(e=P.instance)||e.playSFX("button")},l.onBetDecreaseClicked=function(){var e;this._currentBetIndex>0&&(this._currentBetIndex--,this.updateBetAmount()),null==(e=P.instance)||e.playSFX("button")},l.onBetSliderChanged=function(){this.betSlider&&(this._currentBetIndex=Math.floor(this.betSlider.progress*(this._betAmounts.length-1)),this.updateBetAmount())},l.updateBetAmount=function(){var e=this._betAmounts[this._currentBetIndex];P.instance&&(P.instance.currentBet=e),this.betSlider&&(this.betSlider.progress=this._currentBetIndex/(this._betAmounts.length-1)),this.updateUI()},l.onMenuButtonClicked=function(){var e;null==(e=P.instance)||e.playSFX("button")},l.onRecordButtonClicked=function(){var e;this.showRecordPanel(),null==(e=P.instance)||e.playSFX("button")},l.onSettingsButtonClicked=function(){var e;this.showSettingsPanel(),null==(e=P.instance)||e.playSFX("button")},l.onAutoPlayToggleChanged=function(){this.autoPlayToggle&&P.instance&&(P.instance.isAutoPlay=this.autoPlayToggle.isChecked)},l.onSpeedSliderChanged=function(){this.speedSlider&&P.instance&&(P.instance.gameSpeed=.5+2*this.speedSlider.progress)},l.onSoundToggleChanged=function(){this.soundToggle&&w.instance&&S.instance&&(w.instance.sfxEnabled=this.soundToggle.isChecked,this.soundToggle.isChecked||S.instance.stopAllSFX())},l.onMusicToggleChanged=function(){if(this.musicToggle&&w.instance&&S.instance)if(w.instance.bgmEnabled=this.musicToggle.isChecked,this.musicToggle.isChecked){var e=B.instance;S.instance.playBGM(e.RESOURCE_PATHS.BGM_MAIN,!1,1)}else S.instance.fadeBGMOut(1,!0)},i(t,[{key:"_betAmounts",get:function(){return B.instance.BET_AMOUNTS}}]),t}(m)).prototype,"loadingPanel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ne=t(ee.prototype,"menuPanel",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ie=t(ee.prototype,"gamePanel",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oe=t(ee.prototype,"settingsPanel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ae=t(ee.prototype,"recordPanel",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),le=t(ee.prototype,"loadingProgressBar",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),re=t(ee.prototype,"loadingText",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ue=t(ee.prototype,"balanceLabel",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),se=t(ee.prototype,"betLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=t(ee.prototype,"winLabel",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),he=t(ee.prototype,"playButton",[x],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ge=t(ee.prototype,"autoPlayButton",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),de=t(ee.prototype,"maxBetButton",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pe=t(ee.prototype,"menuButton",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),be=t(ee.prototype,"recordButton",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fe=t(ee.prototype,"settingsButton",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),me=t(ee.prototype,"betIncreaseButton",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=t(ee.prototype,"betDecreaseButton",[X],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ye=t(ee.prototype,"betSlider",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Be=t(ee.prototype,"autoPlayPanel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),we=t(ee.prototype,"autoPlayToggle",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Se=t(ee.prototype,"speedSlider",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ce=t(ee.prototype,"soundToggle",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Te=t(ee.prototype,"musicToggle",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ve=t(ee.prototype,"soundVolumeSlider",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ae=t(ee.prototype,"musicVolumeSlider",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ie=t(ee.prototype,"winPopup",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Le=t(ee.prototype,"winAmountLabel",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ze=t(ee.prototype,"winAnimation",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=ee))||Q));l._RF.pop()}}}));

System.register("chunks:///_virtual/WinPopup.ts",["./rollupPluginModLoBabelHelpers.js","cc","./LineViewController.ts","./ScratchCardItemView.ts"],(function(e){var i,n,t,r,o,l,a,u,s,p,c;return{setters:[function(e){i=e.applyDecoratedDescriptor,n=e.inheritsLoose,t=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,l=e._decorator,a=e.Label,u=e.sp,s=e.Component},function(e){p=e.LineViewController},function(e){c=e.ScratchCardItemView}],execute:function(){var b,f,h,w,g,m,z,P,v,y,S,k,W,L,d;o._RF.push({},"62be9CuQfdCvIalwTLXFer3","WinPopup",void 0);var C=l.ccclass,_=l.property;e("WinPopup",(b=C("WinPopup"),f=_(a),h=_([c]),w=_(p),g=_(u.Skeleton),m=_(u.Skeleton),z=_(Number),b((y=i((v=function(e){function i(){for(var i,n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return i=e.call.apply(e,[this].concat(o))||this,t(i,"winPrizeLabel",y,r(i)),t(i,"scratchTicket",S,r(i)),t(i,"lineViewController",k,r(i)),t(i,"prizeSkeleton",W,r(i)),t(i,"prizeSkeleton2",L,r(i)),t(i,"delayClosePopup",d,r(i)),i}n(i,e);var o=i.prototype;return o.configure=function(e,i,n){console.log("[WinPopup] Configuring with result:",e),this.winPrizeLabel&&this.animateWinAmount(0,e.totalWin),this.scratchTicket&&n&&this.scratchTicket.forEach((function(t,r){if(n[r]){var o=e.resultLines[r];o&&t.setNum(o,!1),i.some((function(e){return e.positions.indexOf(r)>=0}))&&t.setWin(.3)}})),this.lineViewController&&this.showWinningLines(i);var t=this.getHighestMultiplier(i);this.playPrizeAnimation(t)},o.showWinningLines=function(e){if(this.lineViewController){var i=this.lineViewController.rowViews;if(i&&0!==i.length){var n=new Set(e.map((function(e){return e.lineIndex})));i.forEach((function(e,i){e&&(n.has(i)?(e.SetSkin(1),console.log("[WinPopup] Line "+i+" set to WIN")):e.SetSkin(2))})),console.log("[WinPopup] Displayed "+e.length+" winning lines in popup")}else console.warn("[WinPopup] No row views available in line controller")}else console.warn("[WinPopup] No line view controller assigned")},o.animateWinAmount=function(e,i){var n=this;if(this.winPrizeLabel)var t=(i-e)/30,r=0,o=setInterval((function(){r++;var l=e+t*r;r>=30?(n.winPrizeLabel.string=Math.floor(i).toString(),clearInterval(o)):n.winPrizeLabel.string=Math.floor(l).toString()}),33.333333333333336)},o.getHighestMultiplier=function(e){return e&&0!==e.length?Math.max.apply(Math,e.map((function(e){return e.multiplier}))):1},o.playPrizeAnimation=function(e){var i="bb_01";3333===e?i="bb_04":300===e||30===e?i="bb_03":7===e||3===e?i="bb_02":1===e?i="bb_01":(i=e>=100?"bb_04":e>=10?"bb_03":e>=2?"bb_02":"bb_01",console.warn("[WinPopup] Unexpected multiplier "+e+", using fallback animation: "+i)),console.log("[WinPopup] Playing animation: "+i+" for multiplier: "+e),this.prizeSkeleton&&this.prizeSkeleton.setAnimation(0,i,!0),this.prizeSkeleton2&&this.prizeSkeleton2.setAnimation(0,i,!0)},i}(s)).prototype,"winPrizeLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=i(v.prototype,"scratchTicket",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),k=i(v.prototype,"lineViewController",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=i(v.prototype,"prizeSkeleton",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=i(v.prototype,"prizeSkeleton2",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=i(v.prototype,"delayClosePopup",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2e3}}),P=v))||P));o._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});